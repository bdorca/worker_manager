(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/*
    HTTP Hawk Authentication Scheme
    Copyright (c) 2012-2014, Eran Hammer <eran@hammer.io>
    BSD Licensed
*/


// Declare namespace

var hawk = {
    internals: {}
};


hawk.client = {

    // Generate an Authorization header for a given request

    /*
        uri: 'http://example.com/resource?a=b' or object generated by hawk.utils.parseUri()
        method: HTTP verb (e.g. 'GET', 'POST')
        options: {

            // Required

            credentials: {
                id: 'dh37fgj492je',
                key: 'aoijedoaijsdlaksjdl',
                algorithm: 'sha256'                                 // 'sha1', 'sha256'
            },

            // Optional

            ext: 'application-specific',                        // Application specific data sent via the ext attribute
            timestamp: Date.now() / 1000,                       // A pre-calculated timestamp in seconds
            nonce: '2334f34f',                                  // A pre-generated nonce
            localtimeOffsetMsec: 400,                           // Time offset to sync with server time (ignored if timestamp provided)
            payload: '{"some":"payload"}',                      // UTF-8 encoded string for body hash generation (ignored if hash provided)
            contentType: 'application/json',                    // Payload content-type (ignored if hash provided)
            hash: 'U4MKKSmiVxk37JCCrAVIjV=',                    // Pre-calculated payload hash
            app: '24s23423f34dx',                               // Oz application id
            dlg: '234sz34tww3sd'                                // Oz delegated-by application id
        }
    */

    header: function (uri, method, options) {

        var result = {
            field: '',
            artifacts: {}
        };

        // Validate inputs

        if (!uri || (typeof uri !== 'string' && typeof uri !== 'object') ||
            !method || typeof method !== 'string' ||
            !options || typeof options !== 'object') {

            result.err = 'Invalid argument type';
            return result;
        }

        // Application time

        var timestamp = options.timestamp || hawk.utils.now(options.localtimeOffsetMsec);

        // Validate credentials

        var credentials = options.credentials;
        if (!credentials ||
            !credentials.id ||
            !credentials.key ||
            !credentials.algorithm) {

            result.err = 'Invalid credentials object';
            return result;
        }

        if (hawk.crypto.algorithms.indexOf(credentials.algorithm) === -1) {
            result.err = 'Unknown algorithm';
            return result;
        }

        // Parse URI

        if (typeof uri === 'string') {
            uri = hawk.utils.parseUri(uri);
        }

        // Calculate signature

        var artifacts = {
            ts: timestamp,
            nonce: options.nonce || hawk.utils.randomString(6),
            method: method,
            resource: uri.resource,
            host: uri.host,
            port: uri.port,
            hash: options.hash,
            ext: options.ext,
            app: options.app,
            dlg: options.dlg
        };

        result.artifacts = artifacts;

        // Calculate payload hash

        if (!artifacts.hash &&
            (options.payload || options.payload === '')) {

            artifacts.hash = hawk.crypto.calculatePayloadHash(options.payload, credentials.algorithm, options.contentType);
        }

        var mac = hawk.crypto.calculateMac('header', credentials, artifacts);

        // Construct header

        var hasExt = artifacts.ext !== null && artifacts.ext !== undefined && artifacts.ext !== '';       // Other falsey values allowed
        var header = 'Hawk id="' + credentials.id +
                     '", ts="' + artifacts.ts +
                     '", nonce="' + artifacts.nonce +
                     (artifacts.hash ? '", hash="' + artifacts.hash : '') +
                     (hasExt ? '", ext="' + hawk.utils.escapeHeaderAttribute(artifacts.ext) : '') +
                     '", mac="' + mac + '"';

        if (artifacts.app) {
            header += ', app="' + artifacts.app +
                      (artifacts.dlg ? '", dlg="' + artifacts.dlg : '') + '"';
        }

        result.field = header;

        return result;
    },

    // Generate a bewit value for a given URI

    /*
        uri: 'http://example.com/resource?a=b'
        options: {

            // Required

            credentials: {
            id: 'dh37fgj492je',
            key: 'aoijedoaijsdlaksjdl',
            algorithm: 'sha256'                             // 'sha1', 'sha256'
            },
            ttlSec: 60 * 60,                                    // TTL in seconds

            // Optional

            ext: 'application-specific',                        // Application specific data sent via the ext attribute
            localtimeOffsetMsec: 400                            // Time offset to sync with server time
         };
    */

    bewit: function (uri, options) {

        // Validate inputs

        if (!uri ||
            (typeof uri !== 'string') ||
            !options ||
            typeof options !== 'object' ||
            !options.ttlSec) {

            return '';
        }

        options.ext = (options.ext === null || options.ext === undefined ? '' : options.ext);       // Zero is valid value

        // Application time

        var now = hawk.utils.now(options.localtimeOffsetMsec);

        // Validate credentials

        var credentials = options.credentials;
        if (!credentials ||
            !credentials.id ||
            !credentials.key ||
            !credentials.algorithm) {

            return '';
        }

        if (hawk.crypto.algorithms.indexOf(credentials.algorithm) === -1) {
            return '';
        }

        // Parse URI

        uri = hawk.utils.parseUri(uri);

        // Calculate signature

        var exp = now + options.ttlSec;
        var mac = hawk.crypto.calculateMac('bewit', credentials, {
            ts: exp,
            nonce: '',
            method: 'GET',
            resource: uri.resource,                            // Maintain trailing '?' and query params
            host: uri.host,
            port: uri.port,
            ext: options.ext
        });

        // Construct bewit: id\exp\mac\ext

        var bewit = credentials.id + '\\' + exp + '\\' + mac + '\\' + options.ext;
        return hawk.utils.base64urlEncode(bewit);
    },

    // Validate server response

    /*
        request:    object created via 'new XMLHttpRequest()' after response received
        artifacts:  object received from header().artifacts
        options: {
            payload:    optional payload received
            required:   specifies if a Server-Authorization header is required. Defaults to 'false'
        }
    */

    authenticate: function (request, credentials, artifacts, options) {

        options = options || {};

        var getHeader = function (name) {

            return request.getResponseHeader ? request.getResponseHeader(name) : request.getHeader(name);
        };

        var wwwAuthenticate = getHeader('www-authenticate');
        if (wwwAuthenticate) {

            // Parse HTTP WWW-Authenticate header

            var wwwAttributes = hawk.utils.parseAuthorizationHeader(wwwAuthenticate, ['ts', 'tsm', 'error']);
            if (!wwwAttributes) {
                return false;
            }

            if (wwwAttributes.ts) {
                var tsm = hawk.crypto.calculateTsMac(wwwAttributes.ts, credentials);
                if (tsm !== wwwAttributes.tsm) {
                    return false;
                }

                hawk.utils.setNtpOffset(wwwAttributes.ts - Math.floor((new Date()).getTime() / 1000));     // Keep offset at 1 second precision
            }
        }

        // Parse HTTP Server-Authorization header

        var serverAuthorization = getHeader('server-authorization');
        if (!serverAuthorization &&
            !options.required) {

            return true;
        }

        var attributes = hawk.utils.parseAuthorizationHeader(serverAuthorization, ['mac', 'ext', 'hash']);
        if (!attributes) {
            return false;
        }

        var modArtifacts = {
            ts: artifacts.ts,
            nonce: artifacts.nonce,
            method: artifacts.method,
            resource: artifacts.resource,
            host: artifacts.host,
            port: artifacts.port,
            hash: attributes.hash,
            ext: attributes.ext,
            app: artifacts.app,
            dlg: artifacts.dlg
        };

        var mac = hawk.crypto.calculateMac('response', credentials, modArtifacts);
        if (mac !== attributes.mac) {
            return false;
        }

        if (!options.payload &&
            options.payload !== '') {

            return true;
        }

        if (!attributes.hash) {
            return false;
        }

        var calculatedHash = hawk.crypto.calculatePayloadHash(options.payload, credentials.algorithm, getHeader('content-type'));
        return (calculatedHash === attributes.hash);
    },

    message: function (host, port, message, options) {

        // Validate inputs

        if (!host || typeof host !== 'string' ||
            !port || typeof port !== 'number' ||
            message === null || message === undefined || typeof message !== 'string' ||
            !options || typeof options !== 'object') {

            return null;
        }

        // Application time

        var timestamp = options.timestamp || hawk.utils.now(options.localtimeOffsetMsec);

        // Validate credentials

        var credentials = options.credentials;
        if (!credentials ||
            !credentials.id ||
            !credentials.key ||
            !credentials.algorithm) {

            // Invalid credential object
            return null;
        }

        if (hawk.crypto.algorithms.indexOf(credentials.algorithm) === -1) {
            return null;
        }

        // Calculate signature

        var artifacts = {
            ts: timestamp,
            nonce: options.nonce || hawk.utils.randomString(6),
            host: host,
            port: port,
            hash: hawk.crypto.calculatePayloadHash(message, credentials.algorithm)
        };

        // Construct authorization

        var result = {
            id: credentials.id,
            ts: artifacts.ts,
            nonce: artifacts.nonce,
            hash: artifacts.hash,
            mac: hawk.crypto.calculateMac('message', credentials, artifacts)
        };

        return result;
    },

    authenticateTimestamp: function (message, credentials, updateClock) {           // updateClock defaults to true

        var tsm = hawk.crypto.calculateTsMac(message.ts, credentials);
        if (tsm !== message.tsm) {
            return false;
        }

        if (updateClock !== false) {
            hawk.utils.setNtpOffset(message.ts - Math.floor((new Date()).getTime() / 1000));    // Keep offset at 1 second precision
        }

        return true;
    }
};


hawk.crypto = {

    headerVersion: '1',

    algorithms: ['sha1', 'sha256'],

    calculateMac: function (type, credentials, options) {

        var normalized = hawk.crypto.generateNormalizedString(type, options);

        var hmac = CryptoJS['Hmac' + credentials.algorithm.toUpperCase()](normalized, credentials.key);
        return hmac.toString(CryptoJS.enc.Base64);
    },

    generateNormalizedString: function (type, options) {

        var normalized = 'hawk.' + hawk.crypto.headerVersion + '.' + type + '\n' +
                         options.ts + '\n' +
                         options.nonce + '\n' +
                         (options.method || '').toUpperCase() + '\n' +
                         (options.resource || '') + '\n' +
                         options.host.toLowerCase() + '\n' +
                         options.port + '\n' +
                         (options.hash || '') + '\n';

        if (options.ext) {
            normalized += options.ext.replace('\\', '\\\\').replace('\n', '\\n');
        }

        normalized += '\n';

        if (options.app) {
            normalized += options.app + '\n' +
                          (options.dlg || '') + '\n';
        }

        return normalized;
    },

    calculatePayloadHash: function (payload, algorithm, contentType) {

        var hash = CryptoJS.algo[algorithm.toUpperCase()].create();
        hash.update('hawk.' + hawk.crypto.headerVersion + '.payload\n');
        hash.update(hawk.utils.parseContentType(contentType) + '\n');
        hash.update(payload);
        hash.update('\n');
        return hash.finalize().toString(CryptoJS.enc.Base64);
    },

    calculateTsMac: function (ts, credentials) {

        var hash = CryptoJS['Hmac' + credentials.algorithm.toUpperCase()]('hawk.' + hawk.crypto.headerVersion + '.ts\n' + ts + '\n', credentials.key);
        return hash.toString(CryptoJS.enc.Base64);
    }
};


// localStorage compatible interface

hawk.internals.LocalStorage = function () {

    this._cache = {};
    this.length = 0;

    this.getItem = function (key) {

        return this._cache.hasOwnProperty(key) ? String(this._cache[key]) : null;
    };

    this.setItem = function (key, value) {

        this._cache[key] = String(value);
        this.length = Object.keys(this._cache).length;
    };

    this.removeItem = function (key) {

        delete this._cache[key];
        this.length = Object.keys(this._cache).length;
    };

    this.clear = function () {

        this._cache = {};
        this.length = 0;
    };

    this.key = function (i) {

        return Object.keys(this._cache)[i || 0];
    };
};


hawk.utils = {

    storage: new hawk.internals.LocalStorage(),

    setStorage: function (storage) {

        var ntpOffset = hawk.utils.storage.getItem('hawk_ntp_offset');
        hawk.utils.storage = storage;
        if (ntpOffset) {
            hawk.utils.setNtpOffset(ntpOffset);
        }
    },

    setNtpOffset: function (offset) {

        try {
            hawk.utils.storage.setItem('hawk_ntp_offset', offset);
        }
        catch (err) {
            console.error('[hawk] could not write to storage.');
            console.error(err);
        }
    },

    getNtpOffset: function () {

        var offset = hawk.utils.storage.getItem('hawk_ntp_offset');
        if (!offset) {
            return 0;
        }

        return parseInt(offset, 10);
    },

    now: function (localtimeOffsetMsec) {

        return Math.floor(((new Date()).getTime() + (localtimeOffsetMsec || 0)) / 1000) + hawk.utils.getNtpOffset();
    },

    escapeHeaderAttribute: function (attribute) {

        return attribute.replace(/\\/g, '\\\\').replace(/\"/g, '\\"');
    },

    parseContentType: function (header) {

        if (!header) {
            return '';
        }

        return header.split(';')[0].replace(/^\s+|\s+$/g, '').toLowerCase();
    },

    parseAuthorizationHeader: function (header, keys) {

        if (!header) {
            return null;
        }

        var headerParts = header.match(/^(\w+)(?:\s+(.*))?$/);       // Header: scheme[ something]
        if (!headerParts) {
            return null;
        }

        var scheme = headerParts[1];
        if (scheme.toLowerCase() !== 'hawk') {
            return null;
        }

        var attributesString = headerParts[2];
        if (!attributesString) {
            return null;
        }

        var attributes = {};
        var verify = attributesString.replace(/(\w+)="([^"\\]*)"\s*(?:,\s*|$)/g, function ($0, $1, $2) {

            // Check valid attribute names

            if (keys.indexOf($1) === -1) {
                return;
            }

            // Allowed attribute value characters: !#$%&'()*+,-./:;<=>?@[]^_`{|}~ and space, a-z, A-Z, 0-9

            if ($2.match(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~]+$/) === null) {
                return;
            }

            // Check for duplicates

            if (attributes.hasOwnProperty($1)) {
                return;
            }

            attributes[$1] = $2;
            return '';
        });

        if (verify !== '') {
            return null;
        }

        return attributes;
    },

    randomString: function (size) {

        var randomSource = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        var len = randomSource.length;

        var result = [];
        for (var i = 0; i < size; ++i) {
            result[i] = randomSource[Math.floor(Math.random() * len)];
        }

        return result.join('');
    },

    uriRegex: /^([^:]+)\:\/\/(?:[^@]*@)?([^\/:]+)(?:\:(\d+))?([^#]*)(?:#.*)?$/,       // scheme://credentials@host:port/resource#fragment
    parseUri: function (input) {

        var parts = input.match(hawk.utils.uriRegex);
        if (!parts) {
            return { host: '', port: '', resource: '' };
        }

        var scheme = parts[1].toLowerCase();
        var uri = {
            host: parts[2],
            port: parts[3] || (scheme === 'http' ? '80' : (scheme === 'https' ? '443' : '')),
            resource: parts[4]
        };

        return uri;
    },

    base64urlEncode: function (value) {

        var wordArray = CryptoJS.enc.Utf8.parse(value);
        var encoded = CryptoJS.enc.Base64.stringify(wordArray);
        return encoded.replace(/\+/g, '-').replace(/\//g, '_').replace(/\=/g, '');
    }
};


// $lab:coverage:off$
/* eslint-disable */

// Based on: Crypto-JS v3.1.2
// Copyright (c) 2009-2013, Jeff Mott. All rights reserved.
// http://code.google.com/p/crypto-js/
// http://code.google.com/p/crypto-js/wiki/License

var CryptoJS = CryptoJS || function (h, r) { var k = {}, l = k.lib = {}, n = function () { }, f = l.Base = { extend: function (a) { n.prototype = this; var b = new n; a && b.mixIn(a); b.hasOwnProperty("init") || (b.init = function () { b.$super.init.apply(this, arguments) }); b.init.prototype = b; b.$super = this; return b }, create: function () { var a = this.extend(); a.init.apply(a, arguments); return a }, init: function () { }, mixIn: function (a) { for (var b in a) a.hasOwnProperty(b) && (this[b] = a[b]); a.hasOwnProperty("toString") && (this.toString = a.toString) }, clone: function () { return this.init.prototype.extend(this) } }, j = l.WordArray = f.extend({ init: function (a, b) { a = this.words = a || []; this.sigBytes = b != r ? b : 4 * a.length }, toString: function (a) { return (a || s).stringify(this) }, concat: function (a) { var b = this.words, d = a.words, c = this.sigBytes; a = a.sigBytes; this.clamp(); if (c % 4) for (var e = 0; e < a; e++) b[c + e >>> 2] |= (d[e >>> 2] >>> 24 - 8 * (e % 4) & 255) << 24 - 8 * ((c + e) % 4); else if (65535 < d.length) for (e = 0; e < a; e += 4) b[c + e >>> 2] = d[e >>> 2]; else b.push.apply(b, d); this.sigBytes += a; return this }, clamp: function () { var a = this.words, b = this.sigBytes; a[b >>> 2] &= 4294967295 << 32 - 8 * (b % 4); a.length = h.ceil(b / 4) }, clone: function () { var a = f.clone.call(this); a.words = this.words.slice(0); return a }, random: function (a) { for (var b = [], d = 0; d < a; d += 4) b.push(4294967296 * h.random() | 0); return new j.init(b, a) } }), m = k.enc = {}, s = m.Hex = { stringify: function (a) { var b = a.words; a = a.sigBytes; for (var d = [], c = 0; c < a; c++) { var e = b[c >>> 2] >>> 24 - 8 * (c % 4) & 255; d.push((e >>> 4).toString(16)); d.push((e & 15).toString(16)) } return d.join("") }, parse: function (a) { for (var b = a.length, d = [], c = 0; c < b; c += 2) d[c >>> 3] |= parseInt(a.substr(c, 2), 16) << 24 - 4 * (c % 8); return new j.init(d, b / 2) } }, p = m.Latin1 = { stringify: function (a) { var b = a.words; a = a.sigBytes; for (var d = [], c = 0; c < a; c++) d.push(String.fromCharCode(b[c >>> 2] >>> 24 - 8 * (c % 4) & 255)); return d.join("") }, parse: function (a) { for (var b = a.length, d = [], c = 0; c < b; c++) d[c >>> 2] |= (a.charCodeAt(c) & 255) << 24 - 8 * (c % 4); return new j.init(d, b) } }, t = m.Utf8 = { stringify: function (a) { try { return decodeURIComponent(escape(p.stringify(a))) } catch (b) { throw Error("Malformed UTF-8 data"); } }, parse: function (a) { return p.parse(unescape(encodeURIComponent(a))) } }, q = l.BufferedBlockAlgorithm = f.extend({ reset: function () { this._data = new j.init; this._nDataBytes = 0 }, _append: function (a) { "string" == typeof a && (a = t.parse(a)); this._data.concat(a); this._nDataBytes += a.sigBytes }, _process: function (a) { var b = this._data, d = b.words, c = b.sigBytes, e = this.blockSize, f = c / (4 * e), f = a ? h.ceil(f) : h.max((f | 0) - this._minBufferSize, 0); a = f * e; c = h.min(4 * a, c); if (a) { for (var g = 0; g < a; g += e) this._doProcessBlock(d, g); g = d.splice(0, a); b.sigBytes -= c } return new j.init(g, c) }, clone: function () { var a = f.clone.call(this); a._data = this._data.clone(); return a }, _minBufferSize: 0 }); l.Hasher = q.extend({ cfg: f.extend(), init: function (a) { this.cfg = this.cfg.extend(a); this.reset() }, reset: function () { q.reset.call(this); this._doReset() }, update: function (a) { this._append(a); this._process(); return this }, finalize: function (a) { a && this._append(a); return this._doFinalize() }, blockSize: 16, _createHelper: function (a) { return function (b, d) { return (new a.init(d)).finalize(b) } }, _createHmacHelper: function (a) { return function (b, d) { return (new u.HMAC.init(a, d)).finalize(b) } } }); var u = k.algo = {}; return k }(Math);
(function () { var k = CryptoJS, b = k.lib, m = b.WordArray, l = b.Hasher, d = [], b = k.algo.SHA1 = l.extend({ _doReset: function () { this._hash = new m.init([1732584193, 4023233417, 2562383102, 271733878, 3285377520]) }, _doProcessBlock: function (n, p) { for (var a = this._hash.words, e = a[0], f = a[1], h = a[2], j = a[3], b = a[4], c = 0; 80 > c; c++) { if (16 > c) d[c] = n[p + c] | 0; else { var g = d[c - 3] ^ d[c - 8] ^ d[c - 14] ^ d[c - 16]; d[c] = g << 1 | g >>> 31 } g = (e << 5 | e >>> 27) + b + d[c]; g = 20 > c ? g + ((f & h | ~f & j) + 1518500249) : 40 > c ? g + ((f ^ h ^ j) + 1859775393) : 60 > c ? g + ((f & h | f & j | h & j) - 1894007588) : g + ((f ^ h ^ j) - 899497514); b = j; j = h; h = f << 30 | f >>> 2; f = e; e = g } a[0] = a[0] + e | 0; a[1] = a[1] + f | 0; a[2] = a[2] + h | 0; a[3] = a[3] + j | 0; a[4] = a[4] + b | 0 }, _doFinalize: function () { var b = this._data, d = b.words, a = 8 * this._nDataBytes, e = 8 * b.sigBytes; d[e >>> 5] |= 128 << 24 - e % 32; d[(e + 64 >>> 9 << 4) + 14] = Math.floor(a / 4294967296); d[(e + 64 >>> 9 << 4) + 15] = a; b.sigBytes = 4 * d.length; this._process(); return this._hash }, clone: function () { var b = l.clone.call(this); b._hash = this._hash.clone(); return b } }); k.SHA1 = l._createHelper(b); k.HmacSHA1 = l._createHmacHelper(b) })();
(function (k) { for (var g = CryptoJS, h = g.lib, v = h.WordArray, j = h.Hasher, h = g.algo, s = [], t = [], u = function (q) { return 4294967296 * (q - (q | 0)) | 0 }, l = 2, b = 0; 64 > b;) { var d; a: { d = l; for (var w = k.sqrt(d), r = 2; r <= w; r++) if (!(d % r)) { d = !1; break a } d = !0 } d && (8 > b && (s[b] = u(k.pow(l, 0.5))), t[b] = u(k.pow(l, 1 / 3)), b++); l++ } var n = [], h = h.SHA256 = j.extend({ _doReset: function () { this._hash = new v.init(s.slice(0)) }, _doProcessBlock: function (q, h) { for (var a = this._hash.words, c = a[0], d = a[1], b = a[2], k = a[3], f = a[4], g = a[5], j = a[6], l = a[7], e = 0; 64 > e; e++) { if (16 > e) n[e] = q[h + e] | 0; else { var m = n[e - 15], p = n[e - 2]; n[e] = ((m << 25 | m >>> 7) ^ (m << 14 | m >>> 18) ^ m >>> 3) + n[e - 7] + ((p << 15 | p >>> 17) ^ (p << 13 | p >>> 19) ^ p >>> 10) + n[e - 16] } m = l + ((f << 26 | f >>> 6) ^ (f << 21 | f >>> 11) ^ (f << 7 | f >>> 25)) + (f & g ^ ~f & j) + t[e] + n[e]; p = ((c << 30 | c >>> 2) ^ (c << 19 | c >>> 13) ^ (c << 10 | c >>> 22)) + (c & d ^ c & b ^ d & b); l = j; j = g; g = f; f = k + m | 0; k = b; b = d; d = c; c = m + p | 0 } a[0] = a[0] + c | 0; a[1] = a[1] + d | 0; a[2] = a[2] + b | 0; a[3] = a[3] + k | 0; a[4] = a[4] + f | 0; a[5] = a[5] + g | 0; a[6] = a[6] + j | 0; a[7] = a[7] + l | 0 }, _doFinalize: function () { var d = this._data, b = d.words, a = 8 * this._nDataBytes, c = 8 * d.sigBytes; b[c >>> 5] |= 128 << 24 - c % 32; b[(c + 64 >>> 9 << 4) + 14] = k.floor(a / 4294967296); b[(c + 64 >>> 9 << 4) + 15] = a; d.sigBytes = 4 * b.length; this._process(); return this._hash }, clone: function () { var b = j.clone.call(this); b._hash = this._hash.clone(); return b } }); g.SHA256 = j._createHelper(h); g.HmacSHA256 = j._createHmacHelper(h) })(Math);
(function () { var c = CryptoJS, k = c.enc.Utf8; c.algo.HMAC = c.lib.Base.extend({ init: function (a, b) { a = this._hasher = new a.init; "string" == typeof b && (b = k.parse(b)); var c = a.blockSize, e = 4 * c; b.sigBytes > e && (b = a.finalize(b)); b.clamp(); for (var f = this._oKey = b.clone(), g = this._iKey = b.clone(), h = f.words, j = g.words, d = 0; d < c; d++) h[d] ^= 1549556828, j[d] ^= 909522486; f.sigBytes = g.sigBytes = e; this.reset() }, reset: function () { var a = this._hasher; a.reset(); a.update(this._iKey) }, update: function (a) { this._hasher.update(a); return this }, finalize: function (a) { var b = this._hasher; a = b.finalize(a); b.reset(); return b.finalize(this._oKey.clone().concat(a)) } }) })();
(function () { var h = CryptoJS, j = h.lib.WordArray; h.enc.Base64 = { stringify: function (b) { var e = b.words, f = b.sigBytes, c = this._map; b.clamp(); b = []; for (var a = 0; a < f; a += 3) for (var d = (e[a >>> 2] >>> 24 - 8 * (a % 4) & 255) << 16 | (e[a + 1 >>> 2] >>> 24 - 8 * ((a + 1) % 4) & 255) << 8 | e[a + 2 >>> 2] >>> 24 - 8 * ((a + 2) % 4) & 255, g = 0; 4 > g && a + 0.75 * g < f; g++) b.push(c.charAt(d >>> 6 * (3 - g) & 63)); if (e = c.charAt(64)) for (; b.length % 4;) b.push(e); return b.join("") }, parse: function (b) { var e = b.length, f = this._map, c = f.charAt(64); c && (c = b.indexOf(c), -1 != c && (e = c)); for (var c = [], a = 0, d = 0; d < e; d++) if (d % 4) { var g = f.indexOf(b.charAt(d - 1)) << 2 * (d % 4), h = f.indexOf(b.charAt(d)) >>> 6 - 2 * (d % 4); c[a >>> 2] |= (g | h) << 24 - 8 * (a % 4); a++ } return j.create(c, a) }, _map: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=" } })();

hawk.crypto.internals = CryptoJS;


// Export if used as a module

if (typeof module !== 'undefined' && module.exports) {
    module.exports = hawk;
}

/* eslint-enable */
// $lab:coverage:on$

},{}],2:[function(require,module,exports){
// Ionic Starter App

// angular.module is a global place for creating, registering and retrieving Angular modules
// 'starter' is the name of this angular module example (also set in a <body> attribute in index.html)
// the 2nd parameter is an array of 'requires'
// 'starter.services' is found in services.js
// 'starter.controllers' is found in controllers.js
angular.module('app', ['ionic', 'app.controllers', 'app.routes', 'app.services', 'app.directives'])

  .run(function ($ionicPlatform) {
    $ionicPlatform.ready(function () {
      // Hide the accessory bar by default (remove this to show the accessory bar above the keyboard
      // for form inputs)
      if (window.cordova && window.cordova.plugins && window.cordova.plugins.Keyboard) {
        cordova.plugins.Keyboard.hideKeyboardAccessoryBar(true);
        cordova.plugins.Keyboard.disableScroll(true);
      }
      if (window.StatusBar) {
        // org.apache.cordova.statusbar required
        StatusBar.styleDefault();
      }
    });
  });

/**init controllers and services modules**/
angular.module('app.controllers', ["app.services"]);
angular.module('app.services', []);


},{}],3:[function(require,module,exports){
/**
 * Created by dorkab on 2016.07.18..
 */

angular.module('app.controllers')

  .controller('detailsCtrl', ['$scope', '$stateParams', '$ionicPopover', 'workerFactory', 'commandFactory', 'WorkerService', function ($scope, $stateParams, $ionicPopover, workerFactory, commandFactory, WorkerService) {

    $scope.selectedWorker = workerFactory.getWorker($stateParams.workerId);
    $scope.commands = commandFactory.getWorkerCommands();
    var poppedOver = false;

    function successCallback(response) {
      console.log(response);
      document.getElementById("worker_status").innerHTML = JSON.stringify(response.data);
      $scope.popover.hide();
    }

    function errorCallback(response) {
      console.log(response);
      $scope.popover.hide();
    }

    WorkerService.status($scope.selectedWorker, successCallback, errorCallback);

    $scope.cmd = function (cmdname) {
      console.log($scope.selectedWorker);
      WorkerService.cmd($scope.selectedWorker, cmdname, successCallback, errorCallback)
    };

    $ionicPopover.fromTemplateUrl('templates/popover.html', {
      scope: $scope
    }).then(function (popover) {
      $scope.popover = popover;
      popover.show();
    });

  }])
  .controller('masterdetailsCtrl', ['$scope', '$stateParams', '$ionicPopover', 'workerFactory', 'commandFactory', 'MasterService', function ($scope, $stateParams, $ionicPopover, workerFactory, commandFactory, MasterService) {

    $scope.selectedWorker = workerFactory.getWorker($stateParams.workerId);
    $scope.commands = commandFactory.getMasterCommands();

    function successCallback(response) {
      console.log(response);
      document.getElementById("master_status").innerHTML = JSON.stringify(response.data);
      $scope.popover.hide();
    }

    function errorCallback(response) {
      console.log(response);
      $scope.popover.hide();
    }

    MasterService.registry($scope.selectedWorker, successCallback, errorCallback);

    $scope.cmd = function (cmdname) {
      console.log($scope.selectedWorker);
      MasterService.cmd($scope.selectedWorker, cmdname, successCallback, errorCallback)
    };

    $ionicPopover.fromTemplateUrl('templates/popover.html', {
      scope: $scope
    }).then(function (popover) {
      $scope.popover = popover;
      popover.show();
    });

  }])
;

},{}],4:[function(require,module,exports){
/**
 * Created by dorkab on 2016.07.18..
 */

angular.module('app.controllers')

  .controller('loginCtrl', ['$scope', '$ionicPopup', '$state', 'RequestService', function ($scope, $ionicPopup, $state, RequestService) {

    $scope.login = function () {
      var customer = document.getElementById('input_customer_id').value;
      var username = document.getElementById('input_user_id').value;
      var password = document.getElementById('input_password').value;
      var user = {
        username: username,
        password: password,
        customer: customer,
        getParams: function () {
          return "username=" + username + "&password=" + password + "&customer=" + customer;
        }
      };
      console.log(user);

      function successCallback(response) {
        console.log("login");
        console.log(response);
        $state.go('menu.workers');
        credentials = {
          key: response.data.key,
          id: response.data.hawk_id,
          algorithm: response.data.algorithm
        };
        localStorage.setItem('credentials', JSON.stringify(credentials));
      }

      function errorCallback(response) {
        console.log("fail");
        showAlert(response.data.message);
      }

      RequestService.sendRequest(mainURL + "login", METHODS.GET, false, successCallback, errorCallback, user.getParams());

    };

    $scope.logout = function () {
      function successCallback(response) {
        console.log("logout");
        console.log(response);
        localStorage.setItem("credentials", "");
        $state.go('login');
      }

      function errorCallback(response) {
        console.log("fail");
        console.log(response);
      }

      RequestService.sendRequest(mainURL + "logout", METHODS.GET, true, successCallback, errorCallback, null)
    };

    showAlert = function (message) {
      var alertPopup = $ionicPopup.alert({
        title: 'Login failed',
        template: message
      });

      alertPopup.then(function (res) {
        console.log('alerted');
      });
    }

  }]);


},{}],5:[function(require,module,exports){
/**
 * Created by dorkab on 2016.07.18..
 */

angular.module('app.controllers')

  .controller('workersCtrl', ['$scope','WorkerService', 'workerFactory','$state',  function ($scope, WorkerService, workerFactory, $state) {

    $scope.workers = workerFactory.getWorkers();

    $scope.selected = function (id) {
      console.log(id)
    };

    $scope.refresh = function () {
      WorkerService.fetch(function() {
        // Stop the ion-refresher from spinning
        $scope.$broadcast('scroll.refreshComplete');
      });
    };

    $scope.toDetails=function(worker){
      if(worker.master){
        $state.go('menu.master_details',{"workerId": worker.id})
      }else{
        $state.go('menu.details',{"workerId": worker.id})
      }
    }

  }]);


},{}],6:[function(require,module,exports){
angular.module('app.directives', [])

.directive('blankDirective', [function(){

}]);


},{}],7:[function(require,module,exports){
angular.module('app.routes', [])

  .config(function ($stateProvider, $urlRouterProvider) {
    // Ionic uses AngularUI Router which uses the concept of states
    // Learn more here: https://github.com/angular-ui/ui-router
    // Set up the various states which the app can be in.
    // Each state's controller can be found in controllers.js
    $stateProvider


      .state('login', {
        url: '/login',
        templateUrl: 'templates/login.html',
        controller: 'loginCtrl'
      })

      .state('menu', {
        url: '/side-menu',
        templateUrl: 'templates/menu.html',
        abstract: true,
        controller: 'loginCtrl'
      })


      .state('menu.workers', {
        url: '/workers',
        views: {
          'side-menu': {
            templateUrl: 'templates/workers.html',
            controller: 'workersCtrl'
          }
        }
      })

      .state('menu.details', {
        url: '/details/{{workerId}}',
        views: {
          'side-menu': {
            templateUrl: 'templates/details.html',
            controller: 'detailsCtrl'
          }
        }
      })
      .state('menu.master_details', {
        url: '/master_details/{{workerId}}',
        views: {
          'side-menu': {
            templateUrl: 'templates/master_details.html',
            controller: 'masterdetailsCtrl'
          }
        }
      });



    $urlRouterProvider.otherwise('/login')


  });

},{}],8:[function(require,module,exports){
/**
 * Created by dorkab on 2016.07.18..
 */
angular.module('app.services')

  .factory('commandFactory', ['RequestService', function (RequestService) {
    workerCommands = [
      {name: 'start', icon: 'ion-play'},
      {name: 'stop', icon: 'ion-stop'},
      {name: 'reload', icon: 'ion-refresh'},
      {name: 'status', icon: 'ion-search'}
    ];

    masterCommands=[
      {name: 'registry', icon: 'ion-play'},
      {name: 'shutdown', icon: 'ion-stop'}
    ];

    return {
      getWorkerCommands: function () {
        return workerCommands
      },
      getMasterCommands: function () {
        return masterCommands
      }
    }
  }]);

},{}],9:[function(require,module,exports){
/**
 * Created by dorkab on 2016.07.18..
 */

Hawk = require("hawk");


angular.module('app.services')

  .service('CredentialService', [function () {
    return {
      hawkHeader: function (url, method) {
        var credentials = JSON.parse(localStorage.getItem("credentials"));
        var header = Hawk.client.header(url, method, {
          credentials: credentials
        });
        return header.field;
      },

      hawkBewit: function (url) {
        var credentials = JSON.parse(localStorage.getItem("credentials"));
        var bewit = Hawk.client.bewit(url, {
          credentials: credentials,
          ttlSec: 300
        });
        return {'bewit': bewit};
      }
    }
  }])

  .service('RequestService', ['$http', 'CredentialService', function ($http, CredentialService) {
    function sendRequest(url, method, needCred, succesCallback, errorCallback, params, finallyCallback) {

      if(params) {
        url += "?" + params;
      }
      var requestOptions = {
        url: url,
        method: method,
        headers: {Accept: "application/json"}
      };

      if (needCred) {
        requestOptions.headers.Authorization = CredentialService.hawkHeader(url, method);
        // requestOptions.params = CredentialService.hawkBewit(url);
      }
      console.log(requestOptions);
      $http(requestOptions).then(succesCallback, errorCallback).finally(finallyCallback);
    }

    return {
      sendRequest: sendRequest
    }
  }]);




},{"hawk":1}],10:[function(require,module,exports){
/**
 * Created by dorkab on 2016.07.18..
 */
angular.module('app.services')

  .factory('workerFactory', [function () {
    var workerList = [];

    function setWorkerData(id, data) {
      for (var i = 0; i < workerList.length; i++) {
        if (workerList[i].id.indexOf(id) > -1) {
          workerList[i].status = data.currStatus.status;
          workerList[i].data = data;
          console.log(workerList[i].status);
          return;
        }
      }

    }

    function addWorker(worker){
      workerList[workerList.length]=worker;
    }

    return {
      getWorkers: function () {
        return workerList;
      },
      getWorker: function (workerId) {
        for (var i = 0; i < workerList.length; i++) {
          if (workerList[i].id === workerId) {
            return workerList[i];
          }
        }
      },
      setWorkerData: setWorkerData,
      addWorker: addWorker
    }


  }])

  .service('WorkerService', ['RequestService', 'workerFactory', function (RequestService, workerFactory) {

    var COMMAND_TYPE = {
      start: 'start',
      stop: 'stop',
      reload: 'reload',
      status: 'status'
    };

    function cmd(worker, workercmd, successCallback, errorCallback) {
      params = {
        workercmd: workercmd,
        workeraddr: worker.id,
        getParams: function () {
          return "workercmd=" + this.workercmd + "&workeraddr=" + this.workeraddr;
        }
      };
      if (workercmd == COMMAND_TYPE.reload) {
        function defSuccessCallback(response) {
          var id = response.data.result.id;
          var data = response.data.result;
          workerFactory.setWorkerData(id, data);
          successCallback(resopnse);
        }

        RequestService.sendRequest(mainURL + "controller/workercmd", METHODS.POST, true, defSuccessCallback, errorCallback, params.getParams());
      } else {
        RequestService.sendRequest(mainURL + "controller/workercmd", METHODS.POST, true, successCallback, errorCallback, params.getParams());
      }
    }

    this.start = function (worker, successCallback, errorCallback) {
      cmd(worker, COMMAND_TYPE.start, successCallback, errorCallback)
    };
    this.stop = function (worker, successCallback, errorCallback) {
      cmd(worker, COMMAND_TYPE.stop, successCallback, errorCallback)
    };
    this.reload = function (worker, successCallback, errorCallback) {
      cmd(worker, COMMAND_TYPE.reload, successCallback, errorCallback)
    };
    this.status = function (worker, successCallback, errorCallback) {
      cmd(worker, COMMAND_TYPE.status, successCallback, errorCallback)
    };
    this.cmd = function (worker, type, successCallback, errorCallback) {
      cmd(worker, type, successCallback, errorCallback)
    };

    function mockFetch() {

      for (var i = 0; i < 10; i++) {
        name = "worker " + i;
        id = i % 9 ?  "/host - worker " + i:"host - worker " + i;
        workerFactory.addWorker({
          name: name,
          id: id,
          master: id.indexOf("/") < 0,
          status: (i % 9) ?  ((i % 4) ? "working":"stopped") :"master",
          data: {}

        });
      }
    }

    this.fetch=function(finallyCallback) {
      function successCallback(response) {
        console.log(response.data);
        var ids = Object.keys(response.data);
        for (var i = 0; i < ids.length; i++) {
          var id = ids[i];
          var name = response.data[id];
          workerFactory.addWorker({
            name: name,
            id: id,
            master: id.indexOf("/") < 0,
            status: "master",
            data: {}
          });
        }
        setStatuses();
      }

      function errorCallback(response) {
        console.log("fail");
        console.log(response.data);
      }

      RequestService.sendRequest(mainURL + "controller/addressbook", METHODS.GET, true, successCallback, errorCallback, null, finallyCallback);
      // mockFetch()
    }

    function setStatuses() {
      var workerList=workerFactory.getWorkers()
      for (var i = 0; i < workerList.length; i++) {
        if (!workerList[i].master) {
          status(workerList[i],
            function (response) {
              console.log(response)
            },
            function (response) {
              console.log(response)
            })
        }
      }
    }


  }])

  .service('MasterService', ['RequestService', function (RequestService) {

    var COMMAND_TYPE = {
      registry: 'registry',
      shutdown: 'shutdown'
    };

    function cmd(worker, mastercmd, successCallback, errorCallback) {
      params = {
        mastercmd: mastercmd,
        masteraddr: worker.id,
        getParams: function () {
          return "mastercmd=" + this.mastercmd + "&masteraddr=" + this.masteraddr;
        }
      };
      if (mastercmd == COMMAND_TYPE.registry) {
        function defSuccessCallback(response) {

          successCallback(response);
        }

        RequestService.sendRequest(mainURL + "controller/mastercmd", METHODS.POST, true, defSuccessCallback, errorCallback, params.getParams());
      } else {
        RequestService.sendRequest(mainURL + "controller/mastercmd", METHODS.POST, true, successCallback, errorCallback, params.getParams());
      }
    }

    return {
      registry: function (worker, successCallback, errorCallback) {
        cmd(worker, COMMAND_TYPE.registry, successCallback, errorCallback)
      },
      shutdown: function (worker, successCallback, errorCallback) {
        cmd(worker, COMMAND_TYPE.shutdown, successCallback, errorCallback)
      },
      cmd: function (worker, type, successCallback, errorCallback) {
        cmd(worker, type, successCallback, errorCallback)
      }
    }
  }]);

},{}],11:[function(require,module,exports){
/**
 * Created by dorkab on 2016.07.18..
 */

mainURL = 'https://msp.mff.hu/v0.2/';
// mainURL = 'http://localhost:30150/';

METHODS = {
  GET: "GET",
  POST: "POST"
};


},{}]},{},[2,3,4,5,6,7,8,9,10,11])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaGF3ay9saWIvYnJvd3Nlci5qcyIsInd3dy9qcy9hcHAuanMiLCJ3d3cvanMvY29udHJvbGxlcnMvRGV0YWlsc0NvbnRyb2xsZXIuanMiLCJ3d3cvanMvY29udHJvbGxlcnMvTG9naW5Db250cm9sbGVyLmpzIiwid3d3L2pzL2NvbnRyb2xsZXJzL1dvcmtlckNvbnRyb2xsZXIuanMiLCJ3d3cvanMvZGlyZWN0aXZlcy5qcyIsInd3dy9qcy9yb3V0ZXMuanMiLCJ3d3cvanMvc2VydmljZXMvRGV0YWlsc1NlcnZpY2VzLmpzIiwid3d3L2pzL3NlcnZpY2VzL0h0dHBTZXJ2aWNlcy5qcyIsInd3dy9qcy9zZXJ2aWNlcy9Xb3JrZXJTZXJ2aWNlcy5qcyIsInd3dy9qcy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDTkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKlxyXG4gICAgSFRUUCBIYXdrIEF1dGhlbnRpY2F0aW9uIFNjaGVtZVxyXG4gICAgQ29weXJpZ2h0IChjKSAyMDEyLTIwMTQsIEVyYW4gSGFtbWVyIDxlcmFuQGhhbW1lci5pbz5cclxuICAgIEJTRCBMaWNlbnNlZFxyXG4qL1xyXG5cclxuXHJcbi8vIERlY2xhcmUgbmFtZXNwYWNlXHJcblxyXG52YXIgaGF3ayA9IHtcclxuICAgIGludGVybmFsczoge31cclxufTtcclxuXHJcblxyXG5oYXdrLmNsaWVudCA9IHtcclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBhbiBBdXRob3JpemF0aW9uIGhlYWRlciBmb3IgYSBnaXZlbiByZXF1ZXN0XHJcblxyXG4gICAgLypcclxuICAgICAgICB1cmk6ICdodHRwOi8vZXhhbXBsZS5jb20vcmVzb3VyY2U/YT1iJyBvciBvYmplY3QgZ2VuZXJhdGVkIGJ5IGhhd2sudXRpbHMucGFyc2VVcmkoKVxyXG4gICAgICAgIG1ldGhvZDogSFRUUCB2ZXJiIChlLmcuICdHRVQnLCAnUE9TVCcpXHJcbiAgICAgICAgb3B0aW9uczoge1xyXG5cclxuICAgICAgICAgICAgLy8gUmVxdWlyZWRcclxuXHJcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiB7XHJcbiAgICAgICAgICAgICAgICBpZDogJ2RoMzdmZ2o0OTJqZScsXHJcbiAgICAgICAgICAgICAgICBrZXk6ICdhb2lqZWRvYWlqc2RsYWtzamRsJyxcclxuICAgICAgICAgICAgICAgIGFsZ29yaXRobTogJ3NoYTI1NicgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAnc2hhMScsICdzaGEyNTYnXHJcbiAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAvLyBPcHRpb25hbFxyXG5cclxuICAgICAgICAgICAgZXh0OiAnYXBwbGljYXRpb24tc3BlY2lmaWMnLCAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGxpY2F0aW9uIHNwZWNpZmljIGRhdGEgc2VudCB2aWEgdGhlIGV4dCBhdHRyaWJ1dGVcclxuICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpIC8gMTAwMCwgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgcHJlLWNhbGN1bGF0ZWQgdGltZXN0YW1wIGluIHNlY29uZHNcclxuICAgICAgICAgICAgbm9uY2U6ICcyMzM0ZjM0ZicsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEEgcHJlLWdlbmVyYXRlZCBub25jZVxyXG4gICAgICAgICAgICBsb2NhbHRpbWVPZmZzZXRNc2VjOiA0MDAsICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGltZSBvZmZzZXQgdG8gc3luYyB3aXRoIHNlcnZlciB0aW1lIChpZ25vcmVkIGlmIHRpbWVzdGFtcCBwcm92aWRlZClcclxuICAgICAgICAgICAgcGF5bG9hZDogJ3tcInNvbWVcIjpcInBheWxvYWRcIn0nLCAgICAgICAgICAgICAgICAgICAgICAvLyBVVEYtOCBlbmNvZGVkIHN0cmluZyBmb3IgYm9keSBoYXNoIGdlbmVyYXRpb24gKGlnbm9yZWQgaWYgaGFzaCBwcm92aWRlZClcclxuICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uJywgICAgICAgICAgICAgICAgICAgIC8vIFBheWxvYWQgY29udGVudC10eXBlIChpZ25vcmVkIGlmIGhhc2ggcHJvdmlkZWQpXHJcbiAgICAgICAgICAgIGhhc2g6ICdVNE1LS1NtaVZ4azM3SkNDckFWSWpWPScsICAgICAgICAgICAgICAgICAgICAvLyBQcmUtY2FsY3VsYXRlZCBwYXlsb2FkIGhhc2hcclxuICAgICAgICAgICAgYXBwOiAnMjRzMjM0MjNmMzRkeCcsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE96IGFwcGxpY2F0aW9uIGlkXHJcbiAgICAgICAgICAgIGRsZzogJzIzNHN6MzR0d3czc2QnICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPeiBkZWxlZ2F0ZWQtYnkgYXBwbGljYXRpb24gaWRcclxuICAgICAgICB9XHJcbiAgICAqL1xyXG5cclxuICAgIGhlYWRlcjogZnVuY3Rpb24gKHVyaSwgbWV0aG9kLCBvcHRpb25zKSB7XHJcblxyXG4gICAgICAgIHZhciByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgIGZpZWxkOiAnJyxcclxuICAgICAgICAgICAgYXJ0aWZhY3RzOiB7fVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIFZhbGlkYXRlIGlucHV0c1xyXG5cclxuICAgICAgICBpZiAoIXVyaSB8fCAodHlwZW9mIHVyaSAhPT0gJ3N0cmluZycgJiYgdHlwZW9mIHVyaSAhPT0gJ29iamVjdCcpIHx8XHJcbiAgICAgICAgICAgICFtZXRob2QgfHwgdHlwZW9mIG1ldGhvZCAhPT0gJ3N0cmluZycgfHxcclxuICAgICAgICAgICAgIW9wdGlvbnMgfHwgdHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnKSB7XHJcblxyXG4gICAgICAgICAgICByZXN1bHQuZXJyID0gJ0ludmFsaWQgYXJndW1lbnQgdHlwZSc7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBcHBsaWNhdGlvbiB0aW1lXHJcblxyXG4gICAgICAgIHZhciB0aW1lc3RhbXAgPSBvcHRpb25zLnRpbWVzdGFtcCB8fCBoYXdrLnV0aWxzLm5vdyhvcHRpb25zLmxvY2FsdGltZU9mZnNldE1zZWMpO1xyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSBjcmVkZW50aWFsc1xyXG5cclxuICAgICAgICB2YXIgY3JlZGVudGlhbHMgPSBvcHRpb25zLmNyZWRlbnRpYWxzO1xyXG4gICAgICAgIGlmICghY3JlZGVudGlhbHMgfHxcclxuICAgICAgICAgICAgIWNyZWRlbnRpYWxzLmlkIHx8XHJcbiAgICAgICAgICAgICFjcmVkZW50aWFscy5rZXkgfHxcclxuICAgICAgICAgICAgIWNyZWRlbnRpYWxzLmFsZ29yaXRobSkge1xyXG5cclxuICAgICAgICAgICAgcmVzdWx0LmVyciA9ICdJbnZhbGlkIGNyZWRlbnRpYWxzIG9iamVjdCc7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGF3ay5jcnlwdG8uYWxnb3JpdGhtcy5pbmRleE9mKGNyZWRlbnRpYWxzLmFsZ29yaXRobSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5lcnIgPSAnVW5rbm93biBhbGdvcml0aG0nO1xyXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUGFyc2UgVVJJXHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdXJpID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICB1cmkgPSBoYXdrLnV0aWxzLnBhcnNlVXJpKHVyaSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDYWxjdWxhdGUgc2lnbmF0dXJlXHJcblxyXG4gICAgICAgIHZhciBhcnRpZmFjdHMgPSB7XHJcbiAgICAgICAgICAgIHRzOiB0aW1lc3RhbXAsXHJcbiAgICAgICAgICAgIG5vbmNlOiBvcHRpb25zLm5vbmNlIHx8IGhhd2sudXRpbHMucmFuZG9tU3RyaW5nKDYpLFxyXG4gICAgICAgICAgICBtZXRob2Q6IG1ldGhvZCxcclxuICAgICAgICAgICAgcmVzb3VyY2U6IHVyaS5yZXNvdXJjZSxcclxuICAgICAgICAgICAgaG9zdDogdXJpLmhvc3QsXHJcbiAgICAgICAgICAgIHBvcnQ6IHVyaS5wb3J0LFxyXG4gICAgICAgICAgICBoYXNoOiBvcHRpb25zLmhhc2gsXHJcbiAgICAgICAgICAgIGV4dDogb3B0aW9ucy5leHQsXHJcbiAgICAgICAgICAgIGFwcDogb3B0aW9ucy5hcHAsXHJcbiAgICAgICAgICAgIGRsZzogb3B0aW9ucy5kbGdcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXN1bHQuYXJ0aWZhY3RzID0gYXJ0aWZhY3RzO1xyXG5cclxuICAgICAgICAvLyBDYWxjdWxhdGUgcGF5bG9hZCBoYXNoXHJcblxyXG4gICAgICAgIGlmICghYXJ0aWZhY3RzLmhhc2ggJiZcclxuICAgICAgICAgICAgKG9wdGlvbnMucGF5bG9hZCB8fCBvcHRpb25zLnBheWxvYWQgPT09ICcnKSkge1xyXG5cclxuICAgICAgICAgICAgYXJ0aWZhY3RzLmhhc2ggPSBoYXdrLmNyeXB0by5jYWxjdWxhdGVQYXlsb2FkSGFzaChvcHRpb25zLnBheWxvYWQsIGNyZWRlbnRpYWxzLmFsZ29yaXRobSwgb3B0aW9ucy5jb250ZW50VHlwZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgbWFjID0gaGF3ay5jcnlwdG8uY2FsY3VsYXRlTWFjKCdoZWFkZXInLCBjcmVkZW50aWFscywgYXJ0aWZhY3RzKTtcclxuXHJcbiAgICAgICAgLy8gQ29uc3RydWN0IGhlYWRlclxyXG5cclxuICAgICAgICB2YXIgaGFzRXh0ID0gYXJ0aWZhY3RzLmV4dCAhPT0gbnVsbCAmJiBhcnRpZmFjdHMuZXh0ICE9PSB1bmRlZmluZWQgJiYgYXJ0aWZhY3RzLmV4dCAhPT0gJyc7ICAgICAgIC8vIE90aGVyIGZhbHNleSB2YWx1ZXMgYWxsb3dlZFxyXG4gICAgICAgIHZhciBoZWFkZXIgPSAnSGF3ayBpZD1cIicgKyBjcmVkZW50aWFscy5pZCArXHJcbiAgICAgICAgICAgICAgICAgICAgICdcIiwgdHM9XCInICsgYXJ0aWZhY3RzLnRzICtcclxuICAgICAgICAgICAgICAgICAgICAgJ1wiLCBub25jZT1cIicgKyBhcnRpZmFjdHMubm9uY2UgK1xyXG4gICAgICAgICAgICAgICAgICAgICAoYXJ0aWZhY3RzLmhhc2ggPyAnXCIsIGhhc2g9XCInICsgYXJ0aWZhY3RzLmhhc2ggOiAnJykgK1xyXG4gICAgICAgICAgICAgICAgICAgICAoaGFzRXh0ID8gJ1wiLCBleHQ9XCInICsgaGF3ay51dGlscy5lc2NhcGVIZWFkZXJBdHRyaWJ1dGUoYXJ0aWZhY3RzLmV4dCkgOiAnJykgK1xyXG4gICAgICAgICAgICAgICAgICAgICAnXCIsIG1hYz1cIicgKyBtYWMgKyAnXCInO1xyXG5cclxuICAgICAgICBpZiAoYXJ0aWZhY3RzLmFwcCkge1xyXG4gICAgICAgICAgICBoZWFkZXIgKz0gJywgYXBwPVwiJyArIGFydGlmYWN0cy5hcHAgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgKGFydGlmYWN0cy5kbGcgPyAnXCIsIGRsZz1cIicgKyBhcnRpZmFjdHMuZGxnIDogJycpICsgJ1wiJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJlc3VsdC5maWVsZCA9IGhlYWRlcjtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gR2VuZXJhdGUgYSBiZXdpdCB2YWx1ZSBmb3IgYSBnaXZlbiBVUklcclxuXHJcbiAgICAvKlxyXG4gICAgICAgIHVyaTogJ2h0dHA6Ly9leGFtcGxlLmNvbS9yZXNvdXJjZT9hPWInXHJcbiAgICAgICAgb3B0aW9uczoge1xyXG5cclxuICAgICAgICAgICAgLy8gUmVxdWlyZWRcclxuXHJcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiB7XHJcbiAgICAgICAgICAgIGlkOiAnZGgzN2ZnajQ5MmplJyxcclxuICAgICAgICAgICAga2V5OiAnYW9pamVkb2FpanNkbGFrc2pkbCcsXHJcbiAgICAgICAgICAgIGFsZ29yaXRobTogJ3NoYTI1NicgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICdzaGExJywgJ3NoYTI1NidcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdHRsU2VjOiA2MCAqIDYwLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRUTCBpbiBzZWNvbmRzXHJcblxyXG4gICAgICAgICAgICAvLyBPcHRpb25hbFxyXG5cclxuICAgICAgICAgICAgZXh0OiAnYXBwbGljYXRpb24tc3BlY2lmaWMnLCAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFwcGxpY2F0aW9uIHNwZWNpZmljIGRhdGEgc2VudCB2aWEgdGhlIGV4dCBhdHRyaWJ1dGVcclxuICAgICAgICAgICAgbG9jYWx0aW1lT2Zmc2V0TXNlYzogNDAwICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRpbWUgb2Zmc2V0IHRvIHN5bmMgd2l0aCBzZXJ2ZXIgdGltZVxyXG4gICAgICAgICB9O1xyXG4gICAgKi9cclxuXHJcbiAgICBiZXdpdDogZnVuY3Rpb24gKHVyaSwgb3B0aW9ucykge1xyXG5cclxuICAgICAgICAvLyBWYWxpZGF0ZSBpbnB1dHNcclxuXHJcbiAgICAgICAgaWYgKCF1cmkgfHxcclxuICAgICAgICAgICAgKHR5cGVvZiB1cmkgIT09ICdzdHJpbmcnKSB8fFxyXG4gICAgICAgICAgICAhb3B0aW9ucyB8fFxyXG4gICAgICAgICAgICB0eXBlb2Ygb3B0aW9ucyAhPT0gJ29iamVjdCcgfHxcclxuICAgICAgICAgICAgIW9wdGlvbnMudHRsU2VjKSB7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBvcHRpb25zLmV4dCA9IChvcHRpb25zLmV4dCA9PT0gbnVsbCB8fCBvcHRpb25zLmV4dCA9PT0gdW5kZWZpbmVkID8gJycgOiBvcHRpb25zLmV4dCk7ICAgICAgIC8vIFplcm8gaXMgdmFsaWQgdmFsdWVcclxuXHJcbiAgICAgICAgLy8gQXBwbGljYXRpb24gdGltZVxyXG5cclxuICAgICAgICB2YXIgbm93ID0gaGF3ay51dGlscy5ub3cob3B0aW9ucy5sb2NhbHRpbWVPZmZzZXRNc2VjKTtcclxuXHJcbiAgICAgICAgLy8gVmFsaWRhdGUgY3JlZGVudGlhbHNcclxuXHJcbiAgICAgICAgdmFyIGNyZWRlbnRpYWxzID0gb3B0aW9ucy5jcmVkZW50aWFscztcclxuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzIHx8XHJcbiAgICAgICAgICAgICFjcmVkZW50aWFscy5pZCB8fFxyXG4gICAgICAgICAgICAhY3JlZGVudGlhbHMua2V5IHx8XHJcbiAgICAgICAgICAgICFjcmVkZW50aWFscy5hbGdvcml0aG0pIHtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoYXdrLmNyeXB0by5hbGdvcml0aG1zLmluZGV4T2YoY3JlZGVudGlhbHMuYWxnb3JpdGhtKSA9PT0gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUGFyc2UgVVJJXHJcblxyXG4gICAgICAgIHVyaSA9IGhhd2sudXRpbHMucGFyc2VVcmkodXJpKTtcclxuXHJcbiAgICAgICAgLy8gQ2FsY3VsYXRlIHNpZ25hdHVyZVxyXG5cclxuICAgICAgICB2YXIgZXhwID0gbm93ICsgb3B0aW9ucy50dGxTZWM7XHJcbiAgICAgICAgdmFyIG1hYyA9IGhhd2suY3J5cHRvLmNhbGN1bGF0ZU1hYygnYmV3aXQnLCBjcmVkZW50aWFscywge1xyXG4gICAgICAgICAgICB0czogZXhwLFxyXG4gICAgICAgICAgICBub25jZTogJycsXHJcbiAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgICAgICAgIHJlc291cmNlOiB1cmkucmVzb3VyY2UsICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1haW50YWluIHRyYWlsaW5nICc/JyBhbmQgcXVlcnkgcGFyYW1zXHJcbiAgICAgICAgICAgIGhvc3Q6IHVyaS5ob3N0LFxyXG4gICAgICAgICAgICBwb3J0OiB1cmkucG9ydCxcclxuICAgICAgICAgICAgZXh0OiBvcHRpb25zLmV4dFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDb25zdHJ1Y3QgYmV3aXQ6IGlkXFxleHBcXG1hY1xcZXh0XHJcblxyXG4gICAgICAgIHZhciBiZXdpdCA9IGNyZWRlbnRpYWxzLmlkICsgJ1xcXFwnICsgZXhwICsgJ1xcXFwnICsgbWFjICsgJ1xcXFwnICsgb3B0aW9ucy5leHQ7XHJcbiAgICAgICAgcmV0dXJuIGhhd2sudXRpbHMuYmFzZTY0dXJsRW5jb2RlKGJld2l0KTtcclxuICAgIH0sXHJcblxyXG4gICAgLy8gVmFsaWRhdGUgc2VydmVyIHJlc3BvbnNlXHJcblxyXG4gICAgLypcclxuICAgICAgICByZXF1ZXN0OiAgICBvYmplY3QgY3JlYXRlZCB2aWEgJ25ldyBYTUxIdHRwUmVxdWVzdCgpJyBhZnRlciByZXNwb25zZSByZWNlaXZlZFxyXG4gICAgICAgIGFydGlmYWN0czogIG9iamVjdCByZWNlaXZlZCBmcm9tIGhlYWRlcigpLmFydGlmYWN0c1xyXG4gICAgICAgIG9wdGlvbnM6IHtcclxuICAgICAgICAgICAgcGF5bG9hZDogICAgb3B0aW9uYWwgcGF5bG9hZCByZWNlaXZlZFxyXG4gICAgICAgICAgICByZXF1aXJlZDogICBzcGVjaWZpZXMgaWYgYSBTZXJ2ZXItQXV0aG9yaXphdGlvbiBoZWFkZXIgaXMgcmVxdWlyZWQuIERlZmF1bHRzIHRvICdmYWxzZSdcclxuICAgICAgICB9XHJcbiAgICAqL1xyXG5cclxuICAgIGF1dGhlbnRpY2F0ZTogZnVuY3Rpb24gKHJlcXVlc3QsIGNyZWRlbnRpYWxzLCBhcnRpZmFjdHMsIG9wdGlvbnMpIHtcclxuXHJcbiAgICAgICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XHJcblxyXG4gICAgICAgIHZhciBnZXRIZWFkZXIgPSBmdW5jdGlvbiAobmFtZSkge1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QuZ2V0UmVzcG9uc2VIZWFkZXIgPyByZXF1ZXN0LmdldFJlc3BvbnNlSGVhZGVyKG5hbWUpIDogcmVxdWVzdC5nZXRIZWFkZXIobmFtZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHd3d0F1dGhlbnRpY2F0ZSA9IGdldEhlYWRlcignd3d3LWF1dGhlbnRpY2F0ZScpO1xyXG4gICAgICAgIGlmICh3d3dBdXRoZW50aWNhdGUpIHtcclxuXHJcbiAgICAgICAgICAgIC8vIFBhcnNlIEhUVFAgV1dXLUF1dGhlbnRpY2F0ZSBoZWFkZXJcclxuXHJcbiAgICAgICAgICAgIHZhciB3d3dBdHRyaWJ1dGVzID0gaGF3ay51dGlscy5wYXJzZUF1dGhvcml6YXRpb25IZWFkZXIod3d3QXV0aGVudGljYXRlLCBbJ3RzJywgJ3RzbScsICdlcnJvciddKTtcclxuICAgICAgICAgICAgaWYgKCF3d3dBdHRyaWJ1dGVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh3d3dBdHRyaWJ1dGVzLnRzKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgdHNtID0gaGF3ay5jcnlwdG8uY2FsY3VsYXRlVHNNYWMod3d3QXR0cmlidXRlcy50cywgY3JlZGVudGlhbHMpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRzbSAhPT0gd3d3QXR0cmlidXRlcy50c20pIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgaGF3ay51dGlscy5zZXROdHBPZmZzZXQod3d3QXR0cmlidXRlcy50cyAtIE1hdGguZmxvb3IoKG5ldyBEYXRlKCkpLmdldFRpbWUoKSAvIDEwMDApKTsgICAgIC8vIEtlZXAgb2Zmc2V0IGF0IDEgc2Vjb25kIHByZWNpc2lvblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBQYXJzZSBIVFRQIFNlcnZlci1BdXRob3JpemF0aW9uIGhlYWRlclxyXG5cclxuICAgICAgICB2YXIgc2VydmVyQXV0aG9yaXphdGlvbiA9IGdldEhlYWRlcignc2VydmVyLWF1dGhvcml6YXRpb24nKTtcclxuICAgICAgICBpZiAoIXNlcnZlckF1dGhvcml6YXRpb24gJiZcclxuICAgICAgICAgICAgIW9wdGlvbnMucmVxdWlyZWQpIHtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBoYXdrLnV0aWxzLnBhcnNlQXV0aG9yaXphdGlvbkhlYWRlcihzZXJ2ZXJBdXRob3JpemF0aW9uLCBbJ21hYycsICdleHQnLCAnaGFzaCddKTtcclxuICAgICAgICBpZiAoIWF0dHJpYnV0ZXMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIG1vZEFydGlmYWN0cyA9IHtcclxuICAgICAgICAgICAgdHM6IGFydGlmYWN0cy50cyxcclxuICAgICAgICAgICAgbm9uY2U6IGFydGlmYWN0cy5ub25jZSxcclxuICAgICAgICAgICAgbWV0aG9kOiBhcnRpZmFjdHMubWV0aG9kLFxyXG4gICAgICAgICAgICByZXNvdXJjZTogYXJ0aWZhY3RzLnJlc291cmNlLFxyXG4gICAgICAgICAgICBob3N0OiBhcnRpZmFjdHMuaG9zdCxcclxuICAgICAgICAgICAgcG9ydDogYXJ0aWZhY3RzLnBvcnQsXHJcbiAgICAgICAgICAgIGhhc2g6IGF0dHJpYnV0ZXMuaGFzaCxcclxuICAgICAgICAgICAgZXh0OiBhdHRyaWJ1dGVzLmV4dCxcclxuICAgICAgICAgICAgYXBwOiBhcnRpZmFjdHMuYXBwLFxyXG4gICAgICAgICAgICBkbGc6IGFydGlmYWN0cy5kbGdcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbWFjID0gaGF3ay5jcnlwdG8uY2FsY3VsYXRlTWFjKCdyZXNwb25zZScsIGNyZWRlbnRpYWxzLCBtb2RBcnRpZmFjdHMpO1xyXG4gICAgICAgIGlmIChtYWMgIT09IGF0dHJpYnV0ZXMubWFjKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghb3B0aW9ucy5wYXlsb2FkICYmXHJcbiAgICAgICAgICAgIG9wdGlvbnMucGF5bG9hZCAhPT0gJycpIHtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFhdHRyaWJ1dGVzLmhhc2gpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGNhbGN1bGF0ZWRIYXNoID0gaGF3ay5jcnlwdG8uY2FsY3VsYXRlUGF5bG9hZEhhc2gob3B0aW9ucy5wYXlsb2FkLCBjcmVkZW50aWFscy5hbGdvcml0aG0sIGdldEhlYWRlcignY29udGVudC10eXBlJykpO1xyXG4gICAgICAgIHJldHVybiAoY2FsY3VsYXRlZEhhc2ggPT09IGF0dHJpYnV0ZXMuaGFzaCk7XHJcbiAgICB9LFxyXG5cclxuICAgIG1lc3NhZ2U6IGZ1bmN0aW9uIChob3N0LCBwb3J0LCBtZXNzYWdlLCBvcHRpb25zKSB7XHJcblxyXG4gICAgICAgIC8vIFZhbGlkYXRlIGlucHV0c1xyXG5cclxuICAgICAgICBpZiAoIWhvc3QgfHwgdHlwZW9mIGhvc3QgIT09ICdzdHJpbmcnIHx8XHJcbiAgICAgICAgICAgICFwb3J0IHx8IHR5cGVvZiBwb3J0ICE9PSAnbnVtYmVyJyB8fFxyXG4gICAgICAgICAgICBtZXNzYWdlID09PSBudWxsIHx8IG1lc3NhZ2UgPT09IHVuZGVmaW5lZCB8fCB0eXBlb2YgbWVzc2FnZSAhPT0gJ3N0cmluZycgfHxcclxuICAgICAgICAgICAgIW9wdGlvbnMgfHwgdHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnKSB7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFwcGxpY2F0aW9uIHRpbWVcclxuXHJcbiAgICAgICAgdmFyIHRpbWVzdGFtcCA9IG9wdGlvbnMudGltZXN0YW1wIHx8IGhhd2sudXRpbHMubm93KG9wdGlvbnMubG9jYWx0aW1lT2Zmc2V0TXNlYyk7XHJcblxyXG4gICAgICAgIC8vIFZhbGlkYXRlIGNyZWRlbnRpYWxzXHJcblxyXG4gICAgICAgIHZhciBjcmVkZW50aWFscyA9IG9wdGlvbnMuY3JlZGVudGlhbHM7XHJcbiAgICAgICAgaWYgKCFjcmVkZW50aWFscyB8fFxyXG4gICAgICAgICAgICAhY3JlZGVudGlhbHMuaWQgfHxcclxuICAgICAgICAgICAgIWNyZWRlbnRpYWxzLmtleSB8fFxyXG4gICAgICAgICAgICAhY3JlZGVudGlhbHMuYWxnb3JpdGhtKSB7XHJcblxyXG4gICAgICAgICAgICAvLyBJbnZhbGlkIGNyZWRlbnRpYWwgb2JqZWN0XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhhd2suY3J5cHRvLmFsZ29yaXRobXMuaW5kZXhPZihjcmVkZW50aWFscy5hbGdvcml0aG0pID09PSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENhbGN1bGF0ZSBzaWduYXR1cmVcclxuXHJcbiAgICAgICAgdmFyIGFydGlmYWN0cyA9IHtcclxuICAgICAgICAgICAgdHM6IHRpbWVzdGFtcCxcclxuICAgICAgICAgICAgbm9uY2U6IG9wdGlvbnMubm9uY2UgfHwgaGF3ay51dGlscy5yYW5kb21TdHJpbmcoNiksXHJcbiAgICAgICAgICAgIGhvc3Q6IGhvc3QsXHJcbiAgICAgICAgICAgIHBvcnQ6IHBvcnQsXHJcbiAgICAgICAgICAgIGhhc2g6IGhhd2suY3J5cHRvLmNhbGN1bGF0ZVBheWxvYWRIYXNoKG1lc3NhZ2UsIGNyZWRlbnRpYWxzLmFsZ29yaXRobSlcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBDb25zdHJ1Y3QgYXV0aG9yaXphdGlvblxyXG5cclxuICAgICAgICB2YXIgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICBpZDogY3JlZGVudGlhbHMuaWQsXHJcbiAgICAgICAgICAgIHRzOiBhcnRpZmFjdHMudHMsXHJcbiAgICAgICAgICAgIG5vbmNlOiBhcnRpZmFjdHMubm9uY2UsXHJcbiAgICAgICAgICAgIGhhc2g6IGFydGlmYWN0cy5oYXNoLFxyXG4gICAgICAgICAgICBtYWM6IGhhd2suY3J5cHRvLmNhbGN1bGF0ZU1hYygnbWVzc2FnZScsIGNyZWRlbnRpYWxzLCBhcnRpZmFjdHMpXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH0sXHJcblxyXG4gICAgYXV0aGVudGljYXRlVGltZXN0YW1wOiBmdW5jdGlvbiAobWVzc2FnZSwgY3JlZGVudGlhbHMsIHVwZGF0ZUNsb2NrKSB7ICAgICAgICAgICAvLyB1cGRhdGVDbG9jayBkZWZhdWx0cyB0byB0cnVlXHJcblxyXG4gICAgICAgIHZhciB0c20gPSBoYXdrLmNyeXB0by5jYWxjdWxhdGVUc01hYyhtZXNzYWdlLnRzLCBjcmVkZW50aWFscyk7XHJcbiAgICAgICAgaWYgKHRzbSAhPT0gbWVzc2FnZS50c20pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHVwZGF0ZUNsb2NrICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBoYXdrLnV0aWxzLnNldE50cE9mZnNldChtZXNzYWdlLnRzIC0gTWF0aC5mbG9vcigobmV3IERhdGUoKSkuZ2V0VGltZSgpIC8gMTAwMCkpOyAgICAvLyBLZWVwIG9mZnNldCBhdCAxIHNlY29uZCBwcmVjaXNpb25cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG59O1xyXG5cclxuXHJcbmhhd2suY3J5cHRvID0ge1xyXG5cclxuICAgIGhlYWRlclZlcnNpb246ICcxJyxcclxuXHJcbiAgICBhbGdvcml0aG1zOiBbJ3NoYTEnLCAnc2hhMjU2J10sXHJcblxyXG4gICAgY2FsY3VsYXRlTWFjOiBmdW5jdGlvbiAodHlwZSwgY3JlZGVudGlhbHMsIG9wdGlvbnMpIHtcclxuXHJcbiAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSBoYXdrLmNyeXB0by5nZW5lcmF0ZU5vcm1hbGl6ZWRTdHJpbmcodHlwZSwgb3B0aW9ucyk7XHJcblxyXG4gICAgICAgIHZhciBobWFjID0gQ3J5cHRvSlNbJ0htYWMnICsgY3JlZGVudGlhbHMuYWxnb3JpdGhtLnRvVXBwZXJDYXNlKCldKG5vcm1hbGl6ZWQsIGNyZWRlbnRpYWxzLmtleSk7XHJcbiAgICAgICAgcmV0dXJuIGhtYWMudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLkJhc2U2NCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGdlbmVyYXRlTm9ybWFsaXplZFN0cmluZzogZnVuY3Rpb24gKHR5cGUsIG9wdGlvbnMpIHtcclxuXHJcbiAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSAnaGF3ay4nICsgaGF3ay5jcnlwdG8uaGVhZGVyVmVyc2lvbiArICcuJyArIHR5cGUgKyAnXFxuJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zLnRzICsgJ1xcbicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5ub25jZSArICdcXG4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIChvcHRpb25zLm1ldGhvZCB8fCAnJykudG9VcHBlckNhc2UoKSArICdcXG4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIChvcHRpb25zLnJlc291cmNlIHx8ICcnKSArICdcXG4nICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaG9zdC50b0xvd2VyQ2FzZSgpICsgJ1xcbicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5wb3J0ICsgJ1xcbicgK1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgKG9wdGlvbnMuaGFzaCB8fCAnJykgKyAnXFxuJztcclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuZXh0KSB7XHJcbiAgICAgICAgICAgIG5vcm1hbGl6ZWQgKz0gb3B0aW9ucy5leHQucmVwbGFjZSgnXFxcXCcsICdcXFxcXFxcXCcpLnJlcGxhY2UoJ1xcbicsICdcXFxcbicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbm9ybWFsaXplZCArPSAnXFxuJztcclxuXHJcbiAgICAgICAgaWYgKG9wdGlvbnMuYXBwKSB7XHJcbiAgICAgICAgICAgIG5vcm1hbGl6ZWQgKz0gb3B0aW9ucy5hcHAgKyAnXFxuJyArXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKG9wdGlvbnMuZGxnIHx8ICcnKSArICdcXG4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG5vcm1hbGl6ZWQ7XHJcbiAgICB9LFxyXG5cclxuICAgIGNhbGN1bGF0ZVBheWxvYWRIYXNoOiBmdW5jdGlvbiAocGF5bG9hZCwgYWxnb3JpdGhtLCBjb250ZW50VHlwZSkge1xyXG5cclxuICAgICAgICB2YXIgaGFzaCA9IENyeXB0b0pTLmFsZ29bYWxnb3JpdGhtLnRvVXBwZXJDYXNlKCldLmNyZWF0ZSgpO1xyXG4gICAgICAgIGhhc2gudXBkYXRlKCdoYXdrLicgKyBoYXdrLmNyeXB0by5oZWFkZXJWZXJzaW9uICsgJy5wYXlsb2FkXFxuJyk7XHJcbiAgICAgICAgaGFzaC51cGRhdGUoaGF3ay51dGlscy5wYXJzZUNvbnRlbnRUeXBlKGNvbnRlbnRUeXBlKSArICdcXG4nKTtcclxuICAgICAgICBoYXNoLnVwZGF0ZShwYXlsb2FkKTtcclxuICAgICAgICBoYXNoLnVwZGF0ZSgnXFxuJyk7XHJcbiAgICAgICAgcmV0dXJuIGhhc2guZmluYWxpemUoKS50b1N0cmluZyhDcnlwdG9KUy5lbmMuQmFzZTY0KTtcclxuICAgIH0sXHJcblxyXG4gICAgY2FsY3VsYXRlVHNNYWM6IGZ1bmN0aW9uICh0cywgY3JlZGVudGlhbHMpIHtcclxuXHJcbiAgICAgICAgdmFyIGhhc2ggPSBDcnlwdG9KU1snSG1hYycgKyBjcmVkZW50aWFscy5hbGdvcml0aG0udG9VcHBlckNhc2UoKV0oJ2hhd2suJyArIGhhd2suY3J5cHRvLmhlYWRlclZlcnNpb24gKyAnLnRzXFxuJyArIHRzICsgJ1xcbicsIGNyZWRlbnRpYWxzLmtleSk7XHJcbiAgICAgICAgcmV0dXJuIGhhc2gudG9TdHJpbmcoQ3J5cHRvSlMuZW5jLkJhc2U2NCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG5cclxuLy8gbG9jYWxTdG9yYWdlIGNvbXBhdGlibGUgaW50ZXJmYWNlXHJcblxyXG5oYXdrLmludGVybmFscy5Mb2NhbFN0b3JhZ2UgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgdGhpcy5fY2FjaGUgPSB7fTtcclxuICAgIHRoaXMubGVuZ3RoID0gMDtcclxuXHJcbiAgICB0aGlzLmdldEl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZS5oYXNPd25Qcm9wZXJ0eShrZXkpID8gU3RyaW5nKHRoaXMuX2NhY2hlW2tleV0pIDogbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5zZXRJdGVtID0gZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcclxuXHJcbiAgICAgICAgdGhpcy5fY2FjaGVba2V5XSA9IFN0cmluZyh2YWx1ZSk7XHJcbiAgICAgICAgdGhpcy5sZW5ndGggPSBPYmplY3Qua2V5cyh0aGlzLl9jYWNoZSkubGVuZ3RoO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnJlbW92ZUl0ZW0gPSBmdW5jdGlvbiAoa2V5KSB7XHJcblxyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9jYWNoZVtrZXldO1xyXG4gICAgICAgIHRoaXMubGVuZ3RoID0gT2JqZWN0LmtleXModGhpcy5fY2FjaGUpLmxlbmd0aDtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgdGhpcy5fY2FjaGUgPSB7fTtcclxuICAgICAgICB0aGlzLmxlbmd0aCA9IDA7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMua2V5ID0gZnVuY3Rpb24gKGkpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX2NhY2hlKVtpIHx8IDBdO1xyXG4gICAgfTtcclxufTtcclxuXHJcblxyXG5oYXdrLnV0aWxzID0ge1xyXG5cclxuICAgIHN0b3JhZ2U6IG5ldyBoYXdrLmludGVybmFscy5Mb2NhbFN0b3JhZ2UoKSxcclxuXHJcbiAgICBzZXRTdG9yYWdlOiBmdW5jdGlvbiAoc3RvcmFnZSkge1xyXG5cclxuICAgICAgICB2YXIgbnRwT2Zmc2V0ID0gaGF3ay51dGlscy5zdG9yYWdlLmdldEl0ZW0oJ2hhd2tfbnRwX29mZnNldCcpO1xyXG4gICAgICAgIGhhd2sudXRpbHMuc3RvcmFnZSA9IHN0b3JhZ2U7XHJcbiAgICAgICAgaWYgKG50cE9mZnNldCkge1xyXG4gICAgICAgICAgICBoYXdrLnV0aWxzLnNldE50cE9mZnNldChudHBPZmZzZXQpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgc2V0TnRwT2Zmc2V0OiBmdW5jdGlvbiAob2Zmc2V0KSB7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGhhd2sudXRpbHMuc3RvcmFnZS5zZXRJdGVtKCdoYXdrX250cF9vZmZzZXQnLCBvZmZzZXQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1toYXdrXSBjb3VsZCBub3Qgd3JpdGUgdG8gc3RvcmFnZS4nKTtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcblxyXG4gICAgZ2V0TnRwT2Zmc2V0OiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIHZhciBvZmZzZXQgPSBoYXdrLnV0aWxzLnN0b3JhZ2UuZ2V0SXRlbSgnaGF3a19udHBfb2Zmc2V0Jyk7XHJcbiAgICAgICAgaWYgKCFvZmZzZXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcGFyc2VJbnQob2Zmc2V0LCAxMCk7XHJcbiAgICB9LFxyXG5cclxuICAgIG5vdzogZnVuY3Rpb24gKGxvY2FsdGltZU9mZnNldE1zZWMpIHtcclxuXHJcbiAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKChuZXcgRGF0ZSgpKS5nZXRUaW1lKCkgKyAobG9jYWx0aW1lT2Zmc2V0TXNlYyB8fCAwKSkgLyAxMDAwKSArIGhhd2sudXRpbHMuZ2V0TnRwT2Zmc2V0KCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGVzY2FwZUhlYWRlckF0dHJpYnV0ZTogZnVuY3Rpb24gKGF0dHJpYnV0ZSkge1xyXG5cclxuICAgICAgICByZXR1cm4gYXR0cmlidXRlLnJlcGxhY2UoL1xcXFwvZywgJ1xcXFxcXFxcJykucmVwbGFjZSgvXFxcIi9nLCAnXFxcXFwiJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHBhcnNlQ29udGVudFR5cGU6IGZ1bmN0aW9uIChoZWFkZXIpIHtcclxuXHJcbiAgICAgICAgaWYgKCFoZWFkZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGhlYWRlci5zcGxpdCgnOycpWzBdLnJlcGxhY2UoL15cXHMrfFxccyskL2csICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBwYXJzZUF1dGhvcml6YXRpb25IZWFkZXI6IGZ1bmN0aW9uIChoZWFkZXIsIGtleXMpIHtcclxuXHJcbiAgICAgICAgaWYgKCFoZWFkZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaGVhZGVyUGFydHMgPSBoZWFkZXIubWF0Y2goL14oXFx3KykoPzpcXHMrKC4qKSk/JC8pOyAgICAgICAvLyBIZWFkZXI6IHNjaGVtZVsgc29tZXRoaW5nXVxyXG4gICAgICAgIGlmICghaGVhZGVyUGFydHMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgc2NoZW1lID0gaGVhZGVyUGFydHNbMV07XHJcbiAgICAgICAgaWYgKHNjaGVtZS50b0xvd2VyQ2FzZSgpICE9PSAnaGF3aycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgYXR0cmlidXRlc1N0cmluZyA9IGhlYWRlclBhcnRzWzJdO1xyXG4gICAgICAgIGlmICghYXR0cmlidXRlc1N0cmluZykge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBhdHRyaWJ1dGVzID0ge307XHJcbiAgICAgICAgdmFyIHZlcmlmeSA9IGF0dHJpYnV0ZXNTdHJpbmcucmVwbGFjZSgvKFxcdyspPVwiKFteXCJcXFxcXSopXCJcXHMqKD86LFxccyp8JCkvZywgZnVuY3Rpb24gKCQwLCAkMSwgJDIpIHtcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIHZhbGlkIGF0dHJpYnV0ZSBuYW1lc1xyXG5cclxuICAgICAgICAgICAgaWYgKGtleXMuaW5kZXhPZigkMSkgPT09IC0xKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIEFsbG93ZWQgYXR0cmlidXRlIHZhbHVlIGNoYXJhY3RlcnM6ICEjJCUmJygpKissLS4vOjs8PT4/QFtdXl9ge3x9fiBhbmQgc3BhY2UsIGEteiwgQS1aLCAwLTlcclxuXHJcbiAgICAgICAgICAgIGlmICgkMi5tYXRjaCgvXlsgXFx3XFwhI1xcJCUmJ1xcKFxcKVxcKlxcKyxcXC1cXC5cXC9cXDo7PFxcPT5cXD9AXFxbXFxdXFxeYFxce1xcfFxcfX5dKyQvKSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgZHVwbGljYXRlc1xyXG5cclxuICAgICAgICAgICAgaWYgKGF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoJDEpKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZXNbJDFdID0gJDI7XHJcbiAgICAgICAgICAgIHJldHVybiAnJztcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHZlcmlmeSAhPT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gYXR0cmlidXRlcztcclxuICAgIH0sXHJcblxyXG4gICAgcmFuZG9tU3RyaW5nOiBmdW5jdGlvbiAoc2l6ZSkge1xyXG5cclxuICAgICAgICB2YXIgcmFuZG9tU291cmNlID0gJ2FiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVowMTIzNDU2Nzg5JztcclxuICAgICAgICB2YXIgbGVuID0gcmFuZG9tU291cmNlLmxlbmd0aDtcclxuXHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdFtpXSA9IHJhbmRvbVNvdXJjZVtNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBsZW4pXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHQuam9pbignJyk7XHJcbiAgICB9LFxyXG5cclxuICAgIHVyaVJlZ2V4OiAvXihbXjpdKylcXDpcXC9cXC8oPzpbXkBdKkApPyhbXlxcLzpdKykoPzpcXDooXFxkKykpPyhbXiNdKikoPzojLiopPyQvLCAgICAgICAvLyBzY2hlbWU6Ly9jcmVkZW50aWFsc0Bob3N0OnBvcnQvcmVzb3VyY2UjZnJhZ21lbnRcclxuICAgIHBhcnNlVXJpOiBmdW5jdGlvbiAoaW5wdXQpIHtcclxuXHJcbiAgICAgICAgdmFyIHBhcnRzID0gaW5wdXQubWF0Y2goaGF3ay51dGlscy51cmlSZWdleCk7XHJcbiAgICAgICAgaWYgKCFwYXJ0cykge1xyXG4gICAgICAgICAgICByZXR1cm4geyBob3N0OiAnJywgcG9ydDogJycsIHJlc291cmNlOiAnJyB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHNjaGVtZSA9IHBhcnRzWzFdLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgdmFyIHVyaSA9IHtcclxuICAgICAgICAgICAgaG9zdDogcGFydHNbMl0sXHJcbiAgICAgICAgICAgIHBvcnQ6IHBhcnRzWzNdIHx8IChzY2hlbWUgPT09ICdodHRwJyA/ICc4MCcgOiAoc2NoZW1lID09PSAnaHR0cHMnID8gJzQ0MycgOiAnJykpLFxyXG4gICAgICAgICAgICByZXNvdXJjZTogcGFydHNbNF1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gdXJpO1xyXG4gICAgfSxcclxuXHJcbiAgICBiYXNlNjR1cmxFbmNvZGU6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cclxuICAgICAgICB2YXIgd29yZEFycmF5ID0gQ3J5cHRvSlMuZW5jLlV0ZjgucGFyc2UodmFsdWUpO1xyXG4gICAgICAgIHZhciBlbmNvZGVkID0gQ3J5cHRvSlMuZW5jLkJhc2U2NC5zdHJpbmdpZnkod29yZEFycmF5KTtcclxuICAgICAgICByZXR1cm4gZW5jb2RlZC5yZXBsYWNlKC9cXCsvZywgJy0nKS5yZXBsYWNlKC9cXC8vZywgJ18nKS5yZXBsYWNlKC9cXD0vZywgJycpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuXHJcbi8vICRsYWI6Y292ZXJhZ2U6b2ZmJFxyXG4vKiBlc2xpbnQtZGlzYWJsZSAqL1xyXG5cclxuLy8gQmFzZWQgb246IENyeXB0by1KUyB2My4xLjJcclxuLy8gQ29weXJpZ2h0IChjKSAyMDA5LTIwMTMsIEplZmYgTW90dC4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuLy8gaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcy9cclxuLy8gaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2NyeXB0by1qcy93aWtpL0xpY2Vuc2VcclxuXHJcbnZhciBDcnlwdG9KUyA9IENyeXB0b0pTIHx8IGZ1bmN0aW9uIChoLCByKSB7IHZhciBrID0ge30sIGwgPSBrLmxpYiA9IHt9LCBuID0gZnVuY3Rpb24gKCkgeyB9LCBmID0gbC5CYXNlID0geyBleHRlbmQ6IGZ1bmN0aW9uIChhKSB7IG4ucHJvdG90eXBlID0gdGhpczsgdmFyIGIgPSBuZXcgbjsgYSAmJiBiLm1peEluKGEpOyBiLmhhc093blByb3BlcnR5KFwiaW5pdFwiKSB8fCAoYi5pbml0ID0gZnVuY3Rpb24gKCkgeyBiLiRzdXBlci5pbml0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfSk7IGIuaW5pdC5wcm90b3R5cGUgPSBiOyBiLiRzdXBlciA9IHRoaXM7IHJldHVybiBiIH0sIGNyZWF0ZTogZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMuZXh0ZW5kKCk7IGEuaW5pdC5hcHBseShhLCBhcmd1bWVudHMpOyByZXR1cm4gYSB9LCBpbml0OiBmdW5jdGlvbiAoKSB7IH0sIG1peEluOiBmdW5jdGlvbiAoYSkgeyBmb3IgKHZhciBiIGluIGEpIGEuaGFzT3duUHJvcGVydHkoYikgJiYgKHRoaXNbYl0gPSBhW2JdKTsgYS5oYXNPd25Qcm9wZXJ0eShcInRvU3RyaW5nXCIpICYmICh0aGlzLnRvU3RyaW5nID0gYS50b1N0cmluZykgfSwgY2xvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuaW5pdC5wcm90b3R5cGUuZXh0ZW5kKHRoaXMpIH0gfSwgaiA9IGwuV29yZEFycmF5ID0gZi5leHRlbmQoeyBpbml0OiBmdW5jdGlvbiAoYSwgYikgeyBhID0gdGhpcy53b3JkcyA9IGEgfHwgW107IHRoaXMuc2lnQnl0ZXMgPSBiICE9IHIgPyBiIDogNCAqIGEubGVuZ3RoIH0sIHRvU3RyaW5nOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gKGEgfHwgcykuc3RyaW5naWZ5KHRoaXMpIH0sIGNvbmNhdDogZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSB0aGlzLndvcmRzLCBkID0gYS53b3JkcywgYyA9IHRoaXMuc2lnQnl0ZXM7IGEgPSBhLnNpZ0J5dGVzOyB0aGlzLmNsYW1wKCk7IGlmIChjICUgNCkgZm9yICh2YXIgZSA9IDA7IGUgPCBhOyBlKyspIGJbYyArIGUgPj4+IDJdIHw9IChkW2UgPj4+IDJdID4+PiAyNCAtIDggKiAoZSAlIDQpICYgMjU1KSA8PCAyNCAtIDggKiAoKGMgKyBlKSAlIDQpOyBlbHNlIGlmICg2NTUzNSA8IGQubGVuZ3RoKSBmb3IgKGUgPSAwOyBlIDwgYTsgZSArPSA0KSBiW2MgKyBlID4+PiAyXSA9IGRbZSA+Pj4gMl07IGVsc2UgYi5wdXNoLmFwcGx5KGIsIGQpOyB0aGlzLnNpZ0J5dGVzICs9IGE7IHJldHVybiB0aGlzIH0sIGNsYW1wOiBmdW5jdGlvbiAoKSB7IHZhciBhID0gdGhpcy53b3JkcywgYiA9IHRoaXMuc2lnQnl0ZXM7IGFbYiA+Pj4gMl0gJj0gNDI5NDk2NzI5NSA8PCAzMiAtIDggKiAoYiAlIDQpOyBhLmxlbmd0aCA9IGguY2VpbChiIC8gNCkgfSwgY2xvbmU6IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSBmLmNsb25lLmNhbGwodGhpcyk7IGEud29yZHMgPSB0aGlzLndvcmRzLnNsaWNlKDApOyByZXR1cm4gYSB9LCByYW5kb206IGZ1bmN0aW9uIChhKSB7IGZvciAodmFyIGIgPSBbXSwgZCA9IDA7IGQgPCBhOyBkICs9IDQpIGIucHVzaCg0Mjk0OTY3Mjk2ICogaC5yYW5kb20oKSB8IDApOyByZXR1cm4gbmV3IGouaW5pdChiLCBhKSB9IH0pLCBtID0gay5lbmMgPSB7fSwgcyA9IG0uSGV4ID0geyBzdHJpbmdpZnk6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS53b3JkczsgYSA9IGEuc2lnQnl0ZXM7IGZvciAodmFyIGQgPSBbXSwgYyA9IDA7IGMgPCBhOyBjKyspIHsgdmFyIGUgPSBiW2MgPj4+IDJdID4+PiAyNCAtIDggKiAoYyAlIDQpICYgMjU1OyBkLnB1c2goKGUgPj4+IDQpLnRvU3RyaW5nKDE2KSk7IGQucHVzaCgoZSAmIDE1KS50b1N0cmluZygxNikpIH0gcmV0dXJuIGQuam9pbihcIlwiKSB9LCBwYXJzZTogZnVuY3Rpb24gKGEpIHsgZm9yICh2YXIgYiA9IGEubGVuZ3RoLCBkID0gW10sIGMgPSAwOyBjIDwgYjsgYyArPSAyKSBkW2MgPj4+IDNdIHw9IHBhcnNlSW50KGEuc3Vic3RyKGMsIDIpLCAxNikgPDwgMjQgLSA0ICogKGMgJSA4KTsgcmV0dXJuIG5ldyBqLmluaXQoZCwgYiAvIDIpIH0gfSwgcCA9IG0uTGF0aW4xID0geyBzdHJpbmdpZnk6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS53b3JkczsgYSA9IGEuc2lnQnl0ZXM7IGZvciAodmFyIGQgPSBbXSwgYyA9IDA7IGMgPCBhOyBjKyspIGQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGJbYyA+Pj4gMl0gPj4+IDI0IC0gOCAqIChjICUgNCkgJiAyNTUpKTsgcmV0dXJuIGQuam9pbihcIlwiKSB9LCBwYXJzZTogZnVuY3Rpb24gKGEpIHsgZm9yICh2YXIgYiA9IGEubGVuZ3RoLCBkID0gW10sIGMgPSAwOyBjIDwgYjsgYysrKSBkW2MgPj4+IDJdIHw9IChhLmNoYXJDb2RlQXQoYykgJiAyNTUpIDw8IDI0IC0gOCAqIChjICUgNCk7IHJldHVybiBuZXcgai5pbml0KGQsIGIpIH0gfSwgdCA9IG0uVXRmOCA9IHsgc3RyaW5naWZ5OiBmdW5jdGlvbiAoYSkgeyB0cnkgeyByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KGVzY2FwZShwLnN0cmluZ2lmeShhKSkpIH0gY2F0Y2ggKGIpIHsgdGhyb3cgRXJyb3IoXCJNYWxmb3JtZWQgVVRGLTggZGF0YVwiKTsgfSB9LCBwYXJzZTogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHAucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KGEpKSkgfSB9LCBxID0gbC5CdWZmZXJlZEJsb2NrQWxnb3JpdGhtID0gZi5leHRlbmQoeyByZXNldDogZnVuY3Rpb24gKCkgeyB0aGlzLl9kYXRhID0gbmV3IGouaW5pdDsgdGhpcy5fbkRhdGFCeXRlcyA9IDAgfSwgX2FwcGVuZDogZnVuY3Rpb24gKGEpIHsgXCJzdHJpbmdcIiA9PSB0eXBlb2YgYSAmJiAoYSA9IHQucGFyc2UoYSkpOyB0aGlzLl9kYXRhLmNvbmNhdChhKTsgdGhpcy5fbkRhdGFCeXRlcyArPSBhLnNpZ0J5dGVzIH0sIF9wcm9jZXNzOiBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IHRoaXMuX2RhdGEsIGQgPSBiLndvcmRzLCBjID0gYi5zaWdCeXRlcywgZSA9IHRoaXMuYmxvY2tTaXplLCBmID0gYyAvICg0ICogZSksIGYgPSBhID8gaC5jZWlsKGYpIDogaC5tYXgoKGYgfCAwKSAtIHRoaXMuX21pbkJ1ZmZlclNpemUsIDApOyBhID0gZiAqIGU7IGMgPSBoLm1pbig0ICogYSwgYyk7IGlmIChhKSB7IGZvciAodmFyIGcgPSAwOyBnIDwgYTsgZyArPSBlKSB0aGlzLl9kb1Byb2Nlc3NCbG9jayhkLCBnKTsgZyA9IGQuc3BsaWNlKDAsIGEpOyBiLnNpZ0J5dGVzIC09IGMgfSByZXR1cm4gbmV3IGouaW5pdChnLCBjKSB9LCBjbG9uZTogZnVuY3Rpb24gKCkgeyB2YXIgYSA9IGYuY2xvbmUuY2FsbCh0aGlzKTsgYS5fZGF0YSA9IHRoaXMuX2RhdGEuY2xvbmUoKTsgcmV0dXJuIGEgfSwgX21pbkJ1ZmZlclNpemU6IDAgfSk7IGwuSGFzaGVyID0gcS5leHRlbmQoeyBjZmc6IGYuZXh0ZW5kKCksIGluaXQ6IGZ1bmN0aW9uIChhKSB7IHRoaXMuY2ZnID0gdGhpcy5jZmcuZXh0ZW5kKGEpOyB0aGlzLnJlc2V0KCkgfSwgcmVzZXQ6IGZ1bmN0aW9uICgpIHsgcS5yZXNldC5jYWxsKHRoaXMpOyB0aGlzLl9kb1Jlc2V0KCkgfSwgdXBkYXRlOiBmdW5jdGlvbiAoYSkgeyB0aGlzLl9hcHBlbmQoYSk7IHRoaXMuX3Byb2Nlc3MoKTsgcmV0dXJuIHRoaXMgfSwgZmluYWxpemU6IGZ1bmN0aW9uIChhKSB7IGEgJiYgdGhpcy5fYXBwZW5kKGEpOyByZXR1cm4gdGhpcy5fZG9GaW5hbGl6ZSgpIH0sIGJsb2NrU2l6ZTogMTYsIF9jcmVhdGVIZWxwZXI6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gKG5ldyBhLmluaXQoZCkpLmZpbmFsaXplKGIpIH0gfSwgX2NyZWF0ZUhtYWNIZWxwZXI6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBmdW5jdGlvbiAoYiwgZCkgeyByZXR1cm4gKG5ldyB1LkhNQUMuaW5pdChhLCBkKSkuZmluYWxpemUoYikgfSB9IH0pOyB2YXIgdSA9IGsuYWxnbyA9IHt9OyByZXR1cm4gayB9KE1hdGgpO1xyXG4oZnVuY3Rpb24gKCkgeyB2YXIgayA9IENyeXB0b0pTLCBiID0gay5saWIsIG0gPSBiLldvcmRBcnJheSwgbCA9IGIuSGFzaGVyLCBkID0gW10sIGIgPSBrLmFsZ28uU0hBMSA9IGwuZXh0ZW5kKHsgX2RvUmVzZXQ6IGZ1bmN0aW9uICgpIHsgdGhpcy5faGFzaCA9IG5ldyBtLmluaXQoWzE3MzI1ODQxOTMsIDQwMjMyMzM0MTcsIDI1NjIzODMxMDIsIDI3MTczMzg3OCwgMzI4NTM3NzUyMF0pIH0sIF9kb1Byb2Nlc3NCbG9jazogZnVuY3Rpb24gKG4sIHApIHsgZm9yICh2YXIgYSA9IHRoaXMuX2hhc2gud29yZHMsIGUgPSBhWzBdLCBmID0gYVsxXSwgaCA9IGFbMl0sIGogPSBhWzNdLCBiID0gYVs0XSwgYyA9IDA7IDgwID4gYzsgYysrKSB7IGlmICgxNiA+IGMpIGRbY10gPSBuW3AgKyBjXSB8IDA7IGVsc2UgeyB2YXIgZyA9IGRbYyAtIDNdIF4gZFtjIC0gOF0gXiBkW2MgLSAxNF0gXiBkW2MgLSAxNl07IGRbY10gPSBnIDw8IDEgfCBnID4+PiAzMSB9IGcgPSAoZSA8PCA1IHwgZSA+Pj4gMjcpICsgYiArIGRbY107IGcgPSAyMCA+IGMgPyBnICsgKChmICYgaCB8IH5mICYgaikgKyAxNTE4NTAwMjQ5KSA6IDQwID4gYyA/IGcgKyAoKGYgXiBoIF4gaikgKyAxODU5Nzc1MzkzKSA6IDYwID4gYyA/IGcgKyAoKGYgJiBoIHwgZiAmIGogfCBoICYgaikgLSAxODk0MDA3NTg4KSA6IGcgKyAoKGYgXiBoIF4gaikgLSA4OTk0OTc1MTQpOyBiID0gajsgaiA9IGg7IGggPSBmIDw8IDMwIHwgZiA+Pj4gMjsgZiA9IGU7IGUgPSBnIH0gYVswXSA9IGFbMF0gKyBlIHwgMDsgYVsxXSA9IGFbMV0gKyBmIHwgMDsgYVsyXSA9IGFbMl0gKyBoIHwgMDsgYVszXSA9IGFbM10gKyBqIHwgMDsgYVs0XSA9IGFbNF0gKyBiIHwgMCB9LCBfZG9GaW5hbGl6ZTogZnVuY3Rpb24gKCkgeyB2YXIgYiA9IHRoaXMuX2RhdGEsIGQgPSBiLndvcmRzLCBhID0gOCAqIHRoaXMuX25EYXRhQnl0ZXMsIGUgPSA4ICogYi5zaWdCeXRlczsgZFtlID4+PiA1XSB8PSAxMjggPDwgMjQgLSBlICUgMzI7IGRbKGUgKyA2NCA+Pj4gOSA8PCA0KSArIDE0XSA9IE1hdGguZmxvb3IoYSAvIDQyOTQ5NjcyOTYpOyBkWyhlICsgNjQgPj4+IDkgPDwgNCkgKyAxNV0gPSBhOyBiLnNpZ0J5dGVzID0gNCAqIGQubGVuZ3RoOyB0aGlzLl9wcm9jZXNzKCk7IHJldHVybiB0aGlzLl9oYXNoIH0sIGNsb25lOiBmdW5jdGlvbiAoKSB7IHZhciBiID0gbC5jbG9uZS5jYWxsKHRoaXMpOyBiLl9oYXNoID0gdGhpcy5faGFzaC5jbG9uZSgpOyByZXR1cm4gYiB9IH0pOyBrLlNIQTEgPSBsLl9jcmVhdGVIZWxwZXIoYik7IGsuSG1hY1NIQTEgPSBsLl9jcmVhdGVIbWFjSGVscGVyKGIpIH0pKCk7XHJcbihmdW5jdGlvbiAoaykgeyBmb3IgKHZhciBnID0gQ3J5cHRvSlMsIGggPSBnLmxpYiwgdiA9IGguV29yZEFycmF5LCBqID0gaC5IYXNoZXIsIGggPSBnLmFsZ28sIHMgPSBbXSwgdCA9IFtdLCB1ID0gZnVuY3Rpb24gKHEpIHsgcmV0dXJuIDQyOTQ5NjcyOTYgKiAocSAtIChxIHwgMCkpIHwgMCB9LCBsID0gMiwgYiA9IDA7IDY0ID4gYjspIHsgdmFyIGQ7IGE6IHsgZCA9IGw7IGZvciAodmFyIHcgPSBrLnNxcnQoZCksIHIgPSAyOyByIDw9IHc7IHIrKykgaWYgKCEoZCAlIHIpKSB7IGQgPSAhMTsgYnJlYWsgYSB9IGQgPSAhMCB9IGQgJiYgKDggPiBiICYmIChzW2JdID0gdShrLnBvdyhsLCAwLjUpKSksIHRbYl0gPSB1KGsucG93KGwsIDEgLyAzKSksIGIrKyk7IGwrKyB9IHZhciBuID0gW10sIGggPSBoLlNIQTI1NiA9IGouZXh0ZW5kKHsgX2RvUmVzZXQ6IGZ1bmN0aW9uICgpIHsgdGhpcy5faGFzaCA9IG5ldyB2LmluaXQocy5zbGljZSgwKSkgfSwgX2RvUHJvY2Vzc0Jsb2NrOiBmdW5jdGlvbiAocSwgaCkgeyBmb3IgKHZhciBhID0gdGhpcy5faGFzaC53b3JkcywgYyA9IGFbMF0sIGQgPSBhWzFdLCBiID0gYVsyXSwgayA9IGFbM10sIGYgPSBhWzRdLCBnID0gYVs1XSwgaiA9IGFbNl0sIGwgPSBhWzddLCBlID0gMDsgNjQgPiBlOyBlKyspIHsgaWYgKDE2ID4gZSkgbltlXSA9IHFbaCArIGVdIHwgMDsgZWxzZSB7IHZhciBtID0gbltlIC0gMTVdLCBwID0gbltlIC0gMl07IG5bZV0gPSAoKG0gPDwgMjUgfCBtID4+PiA3KSBeIChtIDw8IDE0IHwgbSA+Pj4gMTgpIF4gbSA+Pj4gMykgKyBuW2UgLSA3XSArICgocCA8PCAxNSB8IHAgPj4+IDE3KSBeIChwIDw8IDEzIHwgcCA+Pj4gMTkpIF4gcCA+Pj4gMTApICsgbltlIC0gMTZdIH0gbSA9IGwgKyAoKGYgPDwgMjYgfCBmID4+PiA2KSBeIChmIDw8IDIxIHwgZiA+Pj4gMTEpIF4gKGYgPDwgNyB8IGYgPj4+IDI1KSkgKyAoZiAmIGcgXiB+ZiAmIGopICsgdFtlXSArIG5bZV07IHAgPSAoKGMgPDwgMzAgfCBjID4+PiAyKSBeIChjIDw8IDE5IHwgYyA+Pj4gMTMpIF4gKGMgPDwgMTAgfCBjID4+PiAyMikpICsgKGMgJiBkIF4gYyAmIGIgXiBkICYgYik7IGwgPSBqOyBqID0gZzsgZyA9IGY7IGYgPSBrICsgbSB8IDA7IGsgPSBiOyBiID0gZDsgZCA9IGM7IGMgPSBtICsgcCB8IDAgfSBhWzBdID0gYVswXSArIGMgfCAwOyBhWzFdID0gYVsxXSArIGQgfCAwOyBhWzJdID0gYVsyXSArIGIgfCAwOyBhWzNdID0gYVszXSArIGsgfCAwOyBhWzRdID0gYVs0XSArIGYgfCAwOyBhWzVdID0gYVs1XSArIGcgfCAwOyBhWzZdID0gYVs2XSArIGogfCAwOyBhWzddID0gYVs3XSArIGwgfCAwIH0sIF9kb0ZpbmFsaXplOiBmdW5jdGlvbiAoKSB7IHZhciBkID0gdGhpcy5fZGF0YSwgYiA9IGQud29yZHMsIGEgPSA4ICogdGhpcy5fbkRhdGFCeXRlcywgYyA9IDggKiBkLnNpZ0J5dGVzOyBiW2MgPj4+IDVdIHw9IDEyOCA8PCAyNCAtIGMgJSAzMjsgYlsoYyArIDY0ID4+PiA5IDw8IDQpICsgMTRdID0gay5mbG9vcihhIC8gNDI5NDk2NzI5Nik7IGJbKGMgKyA2NCA+Pj4gOSA8PCA0KSArIDE1XSA9IGE7IGQuc2lnQnl0ZXMgPSA0ICogYi5sZW5ndGg7IHRoaXMuX3Byb2Nlc3MoKTsgcmV0dXJuIHRoaXMuX2hhc2ggfSwgY2xvbmU6IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSBqLmNsb25lLmNhbGwodGhpcyk7IGIuX2hhc2ggPSB0aGlzLl9oYXNoLmNsb25lKCk7IHJldHVybiBiIH0gfSk7IGcuU0hBMjU2ID0gai5fY3JlYXRlSGVscGVyKGgpOyBnLkhtYWNTSEEyNTYgPSBqLl9jcmVhdGVIbWFjSGVscGVyKGgpIH0pKE1hdGgpO1xyXG4oZnVuY3Rpb24gKCkgeyB2YXIgYyA9IENyeXB0b0pTLCBrID0gYy5lbmMuVXRmODsgYy5hbGdvLkhNQUMgPSBjLmxpYi5CYXNlLmV4dGVuZCh7IGluaXQ6IGZ1bmN0aW9uIChhLCBiKSB7IGEgPSB0aGlzLl9oYXNoZXIgPSBuZXcgYS5pbml0OyBcInN0cmluZ1wiID09IHR5cGVvZiBiICYmIChiID0gay5wYXJzZShiKSk7IHZhciBjID0gYS5ibG9ja1NpemUsIGUgPSA0ICogYzsgYi5zaWdCeXRlcyA+IGUgJiYgKGIgPSBhLmZpbmFsaXplKGIpKTsgYi5jbGFtcCgpOyBmb3IgKHZhciBmID0gdGhpcy5fb0tleSA9IGIuY2xvbmUoKSwgZyA9IHRoaXMuX2lLZXkgPSBiLmNsb25lKCksIGggPSBmLndvcmRzLCBqID0gZy53b3JkcywgZCA9IDA7IGQgPCBjOyBkKyspIGhbZF0gXj0gMTU0OTU1NjgyOCwgaltkXSBePSA5MDk1MjI0ODY7IGYuc2lnQnl0ZXMgPSBnLnNpZ0J5dGVzID0gZTsgdGhpcy5yZXNldCgpIH0sIHJlc2V0OiBmdW5jdGlvbiAoKSB7IHZhciBhID0gdGhpcy5faGFzaGVyOyBhLnJlc2V0KCk7IGEudXBkYXRlKHRoaXMuX2lLZXkpIH0sIHVwZGF0ZTogZnVuY3Rpb24gKGEpIHsgdGhpcy5faGFzaGVyLnVwZGF0ZShhKTsgcmV0dXJuIHRoaXMgfSwgZmluYWxpemU6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gdGhpcy5faGFzaGVyOyBhID0gYi5maW5hbGl6ZShhKTsgYi5yZXNldCgpOyByZXR1cm4gYi5maW5hbGl6ZSh0aGlzLl9vS2V5LmNsb25lKCkuY29uY2F0KGEpKSB9IH0pIH0pKCk7XHJcbihmdW5jdGlvbiAoKSB7IHZhciBoID0gQ3J5cHRvSlMsIGogPSBoLmxpYi5Xb3JkQXJyYXk7IGguZW5jLkJhc2U2NCA9IHsgc3RyaW5naWZ5OiBmdW5jdGlvbiAoYikgeyB2YXIgZSA9IGIud29yZHMsIGYgPSBiLnNpZ0J5dGVzLCBjID0gdGhpcy5fbWFwOyBiLmNsYW1wKCk7IGIgPSBbXTsgZm9yICh2YXIgYSA9IDA7IGEgPCBmOyBhICs9IDMpIGZvciAodmFyIGQgPSAoZVthID4+PiAyXSA+Pj4gMjQgLSA4ICogKGEgJSA0KSAmIDI1NSkgPDwgMTYgfCAoZVthICsgMSA+Pj4gMl0gPj4+IDI0IC0gOCAqICgoYSArIDEpICUgNCkgJiAyNTUpIDw8IDggfCBlW2EgKyAyID4+PiAyXSA+Pj4gMjQgLSA4ICogKChhICsgMikgJSA0KSAmIDI1NSwgZyA9IDA7IDQgPiBnICYmIGEgKyAwLjc1ICogZyA8IGY7IGcrKykgYi5wdXNoKGMuY2hhckF0KGQgPj4+IDYgKiAoMyAtIGcpICYgNjMpKTsgaWYgKGUgPSBjLmNoYXJBdCg2NCkpIGZvciAoOyBiLmxlbmd0aCAlIDQ7KSBiLnB1c2goZSk7IHJldHVybiBiLmpvaW4oXCJcIikgfSwgcGFyc2U6IGZ1bmN0aW9uIChiKSB7IHZhciBlID0gYi5sZW5ndGgsIGYgPSB0aGlzLl9tYXAsIGMgPSBmLmNoYXJBdCg2NCk7IGMgJiYgKGMgPSBiLmluZGV4T2YoYyksIC0xICE9IGMgJiYgKGUgPSBjKSk7IGZvciAodmFyIGMgPSBbXSwgYSA9IDAsIGQgPSAwOyBkIDwgZTsgZCsrKSBpZiAoZCAlIDQpIHsgdmFyIGcgPSBmLmluZGV4T2YoYi5jaGFyQXQoZCAtIDEpKSA8PCAyICogKGQgJSA0KSwgaCA9IGYuaW5kZXhPZihiLmNoYXJBdChkKSkgPj4+IDYgLSAyICogKGQgJSA0KTsgY1thID4+PiAyXSB8PSAoZyB8IGgpIDw8IDI0IC0gOCAqIChhICUgNCk7IGErKyB9IHJldHVybiBqLmNyZWF0ZShjLCBhKSB9LCBfbWFwOiBcIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89XCIgfSB9KSgpO1xyXG5cclxuaGF3ay5jcnlwdG8uaW50ZXJuYWxzID0gQ3J5cHRvSlM7XHJcblxyXG5cclxuLy8gRXhwb3J0IGlmIHVzZWQgYXMgYSBtb2R1bGVcclxuXHJcbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xyXG4gICAgbW9kdWxlLmV4cG9ydHMgPSBoYXdrO1xyXG59XHJcblxyXG4vKiBlc2xpbnQtZW5hYmxlICovXHJcbi8vICRsYWI6Y292ZXJhZ2U6b24kXHJcbiIsIi8vIElvbmljIFN0YXJ0ZXIgQXBwXG5cbi8vIGFuZ3VsYXIubW9kdWxlIGlzIGEgZ2xvYmFsIHBsYWNlIGZvciBjcmVhdGluZywgcmVnaXN0ZXJpbmcgYW5kIHJldHJpZXZpbmcgQW5ndWxhciBtb2R1bGVzXG4vLyAnc3RhcnRlcicgaXMgdGhlIG5hbWUgb2YgdGhpcyBhbmd1bGFyIG1vZHVsZSBleGFtcGxlIChhbHNvIHNldCBpbiBhIDxib2R5PiBhdHRyaWJ1dGUgaW4gaW5kZXguaHRtbClcbi8vIHRoZSAybmQgcGFyYW1ldGVyIGlzIGFuIGFycmF5IG9mICdyZXF1aXJlcydcbi8vICdzdGFydGVyLnNlcnZpY2VzJyBpcyBmb3VuZCBpbiBzZXJ2aWNlcy5qc1xuLy8gJ3N0YXJ0ZXIuY29udHJvbGxlcnMnIGlzIGZvdW5kIGluIGNvbnRyb2xsZXJzLmpzXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgWydpb25pYycsICdhcHAuY29udHJvbGxlcnMnLCAnYXBwLnJvdXRlcycsICdhcHAuc2VydmljZXMnLCAnYXBwLmRpcmVjdGl2ZXMnXSlcblxuICAucnVuKGZ1bmN0aW9uICgkaW9uaWNQbGF0Zm9ybSkge1xuICAgICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgIC8vIEhpZGUgdGhlIGFjY2Vzc29yeSBiYXIgYnkgZGVmYXVsdCAocmVtb3ZlIHRoaXMgdG8gc2hvdyB0aGUgYWNjZXNzb3J5IGJhciBhYm92ZSB0aGUga2V5Ym9hcmRcbiAgICAgIC8vIGZvciBmb3JtIGlucHV0cylcbiAgICAgIGlmICh3aW5kb3cuY29yZG92YSAmJiB3aW5kb3cuY29yZG92YS5wbHVnaW5zICYmIHdpbmRvdy5jb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQpIHtcbiAgICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmhpZGVLZXlib2FyZEFjY2Vzc29yeUJhcih0cnVlKTtcbiAgICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmRpc2FibGVTY3JvbGwodHJ1ZSk7XG4gICAgICB9XG4gICAgICBpZiAod2luZG93LlN0YXR1c0Jhcikge1xuICAgICAgICAvLyBvcmcuYXBhY2hlLmNvcmRvdmEuc3RhdHVzYmFyIHJlcXVpcmVkXG4gICAgICAgIFN0YXR1c0Jhci5zdHlsZURlZmF1bHQoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbi8qKmluaXQgY29udHJvbGxlcnMgYW5kIHNlcnZpY2VzIG1vZHVsZXMqKi9cbmFuZ3VsYXIubW9kdWxlKCdhcHAuY29udHJvbGxlcnMnLCBbXCJhcHAuc2VydmljZXNcIl0pO1xuYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycsIFtdKTtcblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRvcmthYiBvbiAyMDE2LjA3LjE4Li5cbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwLmNvbnRyb2xsZXJzJylcblxuICAuY29udHJvbGxlcignZGV0YWlsc0N0cmwnLCBbJyRzY29wZScsICckc3RhdGVQYXJhbXMnLCAnJGlvbmljUG9wb3ZlcicsICd3b3JrZXJGYWN0b3J5JywgJ2NvbW1hbmRGYWN0b3J5JywgJ1dvcmtlclNlcnZpY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkc3RhdGVQYXJhbXMsICRpb25pY1BvcG92ZXIsIHdvcmtlckZhY3RvcnksIGNvbW1hbmRGYWN0b3J5LCBXb3JrZXJTZXJ2aWNlKSB7XG5cbiAgICAkc2NvcGUuc2VsZWN0ZWRXb3JrZXIgPSB3b3JrZXJGYWN0b3J5LmdldFdvcmtlcigkc3RhdGVQYXJhbXMud29ya2VySWQpO1xuICAgICRzY29wZS5jb21tYW5kcyA9IGNvbW1hbmRGYWN0b3J5LmdldFdvcmtlckNvbW1hbmRzKCk7XG4gICAgdmFyIHBvcHBlZE92ZXIgPSBmYWxzZTtcblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ3b3JrZXJfc3RhdHVzXCIpLmlubmVySFRNTCA9IEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmRhdGEpO1xuICAgICAgJHNjb3BlLnBvcG92ZXIuaGlkZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICRzY29wZS5wb3BvdmVyLmhpZGUoKTtcbiAgICB9XG5cbiAgICBXb3JrZXJTZXJ2aWNlLnN0YXR1cygkc2NvcGUuc2VsZWN0ZWRXb3JrZXIsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjayk7XG5cbiAgICAkc2NvcGUuY21kID0gZnVuY3Rpb24gKGNtZG5hbWUpIHtcbiAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5zZWxlY3RlZFdvcmtlcik7XG4gICAgICBXb3JrZXJTZXJ2aWNlLmNtZCgkc2NvcGUuc2VsZWN0ZWRXb3JrZXIsIGNtZG5hbWUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaylcbiAgICB9O1xuXG4gICAgJGlvbmljUG9wb3Zlci5mcm9tVGVtcGxhdGVVcmwoJ3RlbXBsYXRlcy9wb3BvdmVyLmh0bWwnLCB7XG4gICAgICBzY29wZTogJHNjb3BlXG4gICAgfSkudGhlbihmdW5jdGlvbiAocG9wb3Zlcikge1xuICAgICAgJHNjb3BlLnBvcG92ZXIgPSBwb3BvdmVyO1xuICAgICAgcG9wb3Zlci5zaG93KCk7XG4gICAgfSk7XG5cbiAgfV0pXG4gIC5jb250cm9sbGVyKCdtYXN0ZXJkZXRhaWxzQ3RybCcsIFsnJHNjb3BlJywgJyRzdGF0ZVBhcmFtcycsICckaW9uaWNQb3BvdmVyJywgJ3dvcmtlckZhY3RvcnknLCAnY29tbWFuZEZhY3RvcnknLCAnTWFzdGVyU2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRzdGF0ZVBhcmFtcywgJGlvbmljUG9wb3Zlciwgd29ya2VyRmFjdG9yeSwgY29tbWFuZEZhY3RvcnksIE1hc3RlclNlcnZpY2UpIHtcblxuICAgICRzY29wZS5zZWxlY3RlZFdvcmtlciA9IHdvcmtlckZhY3RvcnkuZ2V0V29ya2VyKCRzdGF0ZVBhcmFtcy53b3JrZXJJZCk7XG4gICAgJHNjb3BlLmNvbW1hbmRzID0gY29tbWFuZEZhY3RvcnkuZ2V0TWFzdGVyQ29tbWFuZHMoKTtcblxuICAgIGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXN0ZXJfc3RhdHVzXCIpLmlubmVySFRNTCA9IEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmRhdGEpO1xuICAgICAgJHNjb3BlLnBvcG92ZXIuaGlkZSgpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICRzY29wZS5wb3BvdmVyLmhpZGUoKTtcbiAgICB9XG5cbiAgICBNYXN0ZXJTZXJ2aWNlLnJlZ2lzdHJ5KCRzY29wZS5zZWxlY3RlZFdvcmtlciwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKTtcblxuICAgICRzY29wZS5jbWQgPSBmdW5jdGlvbiAoY21kbmFtZSkge1xuICAgICAgY29uc29sZS5sb2coJHNjb3BlLnNlbGVjdGVkV29ya2VyKTtcbiAgICAgIE1hc3RlclNlcnZpY2UuY21kKCRzY29wZS5zZWxlY3RlZFdvcmtlciwgY21kbmFtZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKVxuICAgIH07XG5cbiAgICAkaW9uaWNQb3BvdmVyLmZyb21UZW1wbGF0ZVVybCgndGVtcGxhdGVzL3BvcG92ZXIuaHRtbCcsIHtcbiAgICAgIHNjb3BlOiAkc2NvcGVcbiAgICB9KS50aGVuKGZ1bmN0aW9uIChwb3BvdmVyKSB7XG4gICAgICAkc2NvcGUucG9wb3ZlciA9IHBvcG92ZXI7XG4gICAgICBwb3BvdmVyLnNob3coKTtcbiAgICB9KTtcblxuICB9XSlcbjtcbiIsIi8qKlxuICogQ3JlYXRlZCBieSBkb3JrYWIgb24gMjAxNi4wNy4xOC4uXG4gKi9cblxuYW5ndWxhci5tb2R1bGUoJ2FwcC5jb250cm9sbGVycycpXG5cbiAgLmNvbnRyb2xsZXIoJ2xvZ2luQ3RybCcsIFsnJHNjb3BlJywgJyRpb25pY1BvcHVwJywgJyRzdGF0ZScsICdSZXF1ZXN0U2VydmljZScsIGZ1bmN0aW9uICgkc2NvcGUsICRpb25pY1BvcHVwLCAkc3RhdGUsIFJlcXVlc3RTZXJ2aWNlKSB7XG5cbiAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgY3VzdG9tZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRfY3VzdG9tZXJfaWQnKS52YWx1ZTtcbiAgICAgIHZhciB1c2VybmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dF91c2VyX2lkJykudmFsdWU7XG4gICAgICB2YXIgcGFzc3dvcmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRfcGFzc3dvcmQnKS52YWx1ZTtcbiAgICAgIHZhciB1c2VyID0ge1xuICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZCxcbiAgICAgICAgY3VzdG9tZXI6IGN1c3RvbWVyLFxuICAgICAgICBnZXRQYXJhbXM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gXCJ1c2VybmFtZT1cIiArIHVzZXJuYW1lICsgXCImcGFzc3dvcmQ9XCIgKyBwYXNzd29yZCArIFwiJmN1c3RvbWVyPVwiICsgY3VzdG9tZXI7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zb2xlLmxvZyh1c2VyKTtcblxuICAgICAgZnVuY3Rpb24gc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwibG9naW5cIik7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTtcbiAgICAgICAgJHN0YXRlLmdvKCdtZW51LndvcmtlcnMnKTtcbiAgICAgICAgY3JlZGVudGlhbHMgPSB7XG4gICAgICAgICAga2V5OiByZXNwb25zZS5kYXRhLmtleSxcbiAgICAgICAgICBpZDogcmVzcG9uc2UuZGF0YS5oYXdrX2lkLFxuICAgICAgICAgIGFsZ29yaXRobTogcmVzcG9uc2UuZGF0YS5hbGdvcml0aG1cbiAgICAgICAgfTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2NyZWRlbnRpYWxzJywgSlNPTi5zdHJpbmdpZnkoY3JlZGVudGlhbHMpKTtcbiAgICAgIH1cblxuICAgICAgZnVuY3Rpb24gZXJyb3JDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImZhaWxcIik7XG4gICAgICAgIHNob3dBbGVydChyZXNwb25zZS5kYXRhLm1lc3NhZ2UpO1xuICAgICAgfVxuXG4gICAgICBSZXF1ZXN0U2VydmljZS5zZW5kUmVxdWVzdChtYWluVVJMICsgXCJsb2dpblwiLCBNRVRIT0RTLkdFVCwgZmFsc2UsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaywgdXNlci5nZXRQYXJhbXMoKSk7XG5cbiAgICB9O1xuXG4gICAgJHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIGZ1bmN0aW9uIHN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcImxvZ291dFwiKTtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImNyZWRlbnRpYWxzXCIsIFwiXCIpO1xuICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJmYWlsXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7XG4gICAgICB9XG5cbiAgICAgIFJlcXVlc3RTZXJ2aWNlLnNlbmRSZXF1ZXN0KG1haW5VUkwgKyBcImxvZ291dFwiLCBNRVRIT0RTLkdFVCwgdHJ1ZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBudWxsKVxuICAgIH07XG5cbiAgICBzaG93QWxlcnQgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xuICAgICAgdmFyIGFsZXJ0UG9wdXAgPSAkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgIHRpdGxlOiAnTG9naW4gZmFpbGVkJyxcbiAgICAgICAgdGVtcGxhdGU6IG1lc3NhZ2VcbiAgICAgIH0pO1xuXG4gICAgICBhbGVydFBvcHVwLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICBjb25zb2xlLmxvZygnYWxlcnRlZCcpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gIH1dKTtcblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRvcmthYiBvbiAyMDE2LjA3LjE4Li5cbiAqL1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwLmNvbnRyb2xsZXJzJylcblxuICAuY29udHJvbGxlcignd29ya2Vyc0N0cmwnLCBbJyRzY29wZScsJ1dvcmtlclNlcnZpY2UnLCAnd29ya2VyRmFjdG9yeScsJyRzdGF0ZScsICBmdW5jdGlvbiAoJHNjb3BlLCBXb3JrZXJTZXJ2aWNlLCB3b3JrZXJGYWN0b3J5LCAkc3RhdGUpIHtcblxuICAgICRzY29wZS53b3JrZXJzID0gd29ya2VyRmFjdG9yeS5nZXRXb3JrZXJzKCk7XG5cbiAgICAkc2NvcGUuc2VsZWN0ZWQgPSBmdW5jdGlvbiAoaWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKGlkKVxuICAgIH07XG5cbiAgICAkc2NvcGUucmVmcmVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIFdvcmtlclNlcnZpY2UuZmV0Y2goZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFN0b3AgdGhlIGlvbi1yZWZyZXNoZXIgZnJvbSBzcGlubmluZ1xuICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnc2Nyb2xsLnJlZnJlc2hDb21wbGV0ZScpO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgICRzY29wZS50b0RldGFpbHM9ZnVuY3Rpb24od29ya2VyKXtcbiAgICAgIGlmKHdvcmtlci5tYXN0ZXIpe1xuICAgICAgICAkc3RhdGUuZ28oJ21lbnUubWFzdGVyX2RldGFpbHMnLHtcIndvcmtlcklkXCI6IHdvcmtlci5pZH0pXG4gICAgICB9ZWxzZXtcbiAgICAgICAgJHN0YXRlLmdvKCdtZW51LmRldGFpbHMnLHtcIndvcmtlcklkXCI6IHdvcmtlci5pZH0pXG4gICAgICB9XG4gICAgfVxuXG4gIH1dKTtcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcC5kaXJlY3RpdmVzJywgW10pXG5cbi5kaXJlY3RpdmUoJ2JsYW5rRGlyZWN0aXZlJywgW2Z1bmN0aW9uKCl7XG5cbn1dKTtcblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcC5yb3V0ZXMnLCBbXSlcblxuICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG4gICAgLy8gSW9uaWMgdXNlcyBBbmd1bGFyVUkgUm91dGVyIHdoaWNoIHVzZXMgdGhlIGNvbmNlcHQgb2Ygc3RhdGVzXG4gICAgLy8gTGVhcm4gbW9yZSBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci11aS91aS1yb3V0ZXJcbiAgICAvLyBTZXQgdXAgdGhlIHZhcmlvdXMgc3RhdGVzIHdoaWNoIHRoZSBhcHAgY2FuIGJlIGluLlxuICAgIC8vIEVhY2ggc3RhdGUncyBjb250cm9sbGVyIGNhbiBiZSBmb3VuZCBpbiBjb250cm9sbGVycy5qc1xuICAgICRzdGF0ZVByb3ZpZGVyXG5cblxuICAgICAgLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgICAgdXJsOiAnL2xvZ2luJyxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbG9naW4uaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXG4gICAgICB9KVxuXG4gICAgICAuc3RhdGUoJ21lbnUnLCB7XG4gICAgICAgIHVybDogJy9zaWRlLW1lbnUnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9tZW51Lmh0bWwnLFxuICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ3RybCdcbiAgICAgIH0pXG5cblxuICAgICAgLnN0YXRlKCdtZW51LndvcmtlcnMnLCB7XG4gICAgICAgIHVybDogJy93b3JrZXJzJyxcbiAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAnc2lkZS1tZW51Jzoge1xuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvd29ya2Vycy5odG1sJyxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd3b3JrZXJzQ3RybCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC5zdGF0ZSgnbWVudS5kZXRhaWxzJywge1xuICAgICAgICB1cmw6ICcvZGV0YWlscy97e3dvcmtlcklkfX0nLFxuICAgICAgICB2aWV3czoge1xuICAgICAgICAgICdzaWRlLW1lbnUnOiB7XG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9kZXRhaWxzLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2RldGFpbHNDdHJsJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5zdGF0ZSgnbWVudS5tYXN0ZXJfZGV0YWlscycsIHtcbiAgICAgICAgdXJsOiAnL21hc3Rlcl9kZXRhaWxzL3t7d29ya2VySWR9fScsXG4gICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgJ3NpZGUtbWVudSc6IHtcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL21hc3Rlcl9kZXRhaWxzLmh0bWwnLFxuICAgICAgICAgICAgY29udHJvbGxlcjogJ21hc3RlcmRldGFpbHNDdHJsJ1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cblxuXG4gICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2xvZ2luJylcblxuXG4gIH0pO1xuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRvcmthYiBvbiAyMDE2LjA3LjE4Li5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycpXG5cbiAgLmZhY3RvcnkoJ2NvbW1hbmRGYWN0b3J5JywgWydSZXF1ZXN0U2VydmljZScsIGZ1bmN0aW9uIChSZXF1ZXN0U2VydmljZSkge1xuICAgIHdvcmtlckNvbW1hbmRzID0gW1xuICAgICAge25hbWU6ICdzdGFydCcsIGljb246ICdpb24tcGxheSd9LFxuICAgICAge25hbWU6ICdzdG9wJywgaWNvbjogJ2lvbi1zdG9wJ30sXG4gICAgICB7bmFtZTogJ3JlbG9hZCcsIGljb246ICdpb24tcmVmcmVzaCd9LFxuICAgICAge25hbWU6ICdzdGF0dXMnLCBpY29uOiAnaW9uLXNlYXJjaCd9XG4gICAgXTtcblxuICAgIG1hc3RlckNvbW1hbmRzPVtcbiAgICAgIHtuYW1lOiAncmVnaXN0cnknLCBpY29uOiAnaW9uLXBsYXknfSxcbiAgICAgIHtuYW1lOiAnc2h1dGRvd24nLCBpY29uOiAnaW9uLXN0b3AnfVxuICAgIF07XG5cbiAgICByZXR1cm4ge1xuICAgICAgZ2V0V29ya2VyQ29tbWFuZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHdvcmtlckNvbW1hbmRzXG4gICAgICB9LFxuICAgICAgZ2V0TWFzdGVyQ29tbWFuZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG1hc3RlckNvbW1hbmRzXG4gICAgICB9XG4gICAgfVxuICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgZG9ya2FiIG9uIDIwMTYuMDcuMTguLlxuICovXG5cbkhhd2sgPSByZXF1aXJlKFwiaGF3a1wiKTtcblxuXG5hbmd1bGFyLm1vZHVsZSgnYXBwLnNlcnZpY2VzJylcblxuICAuc2VydmljZSgnQ3JlZGVudGlhbFNlcnZpY2UnLCBbZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICBoYXdrSGVhZGVyOiBmdW5jdGlvbiAodXJsLCBtZXRob2QpIHtcbiAgICAgICAgdmFyIGNyZWRlbnRpYWxzID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcImNyZWRlbnRpYWxzXCIpKTtcbiAgICAgICAgdmFyIGhlYWRlciA9IEhhd2suY2xpZW50LmhlYWRlcih1cmwsIG1ldGhvZCwge1xuICAgICAgICAgIGNyZWRlbnRpYWxzOiBjcmVkZW50aWFsc1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGhlYWRlci5maWVsZDtcbiAgICAgIH0sXG5cbiAgICAgIGhhd2tCZXdpdDogZnVuY3Rpb24gKHVybCkge1xuICAgICAgICB2YXIgY3JlZGVudGlhbHMgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY3JlZGVudGlhbHNcIikpO1xuICAgICAgICB2YXIgYmV3aXQgPSBIYXdrLmNsaWVudC5iZXdpdCh1cmwsIHtcbiAgICAgICAgICBjcmVkZW50aWFsczogY3JlZGVudGlhbHMsXG4gICAgICAgICAgdHRsU2VjOiAzMDBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB7J2Jld2l0JzogYmV3aXR9O1xuICAgICAgfVxuICAgIH1cbiAgfV0pXG5cbiAgLnNlcnZpY2UoJ1JlcXVlc3RTZXJ2aWNlJywgWyckaHR0cCcsICdDcmVkZW50aWFsU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgQ3JlZGVudGlhbFNlcnZpY2UpIHtcbiAgICBmdW5jdGlvbiBzZW5kUmVxdWVzdCh1cmwsIG1ldGhvZCwgbmVlZENyZWQsIHN1Y2Nlc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBwYXJhbXMsIGZpbmFsbHlDYWxsYmFjaykge1xuXG4gICAgICBpZihwYXJhbXMpIHtcbiAgICAgICAgdXJsICs9IFwiP1wiICsgcGFyYW1zO1xuICAgICAgfVxuICAgICAgdmFyIHJlcXVlc3RPcHRpb25zID0ge1xuICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICAgIGhlYWRlcnM6IHtBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwifVxuICAgICAgfTtcblxuICAgICAgaWYgKG5lZWRDcmVkKSB7XG4gICAgICAgIHJlcXVlc3RPcHRpb25zLmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9IENyZWRlbnRpYWxTZXJ2aWNlLmhhd2tIZWFkZXIodXJsLCBtZXRob2QpO1xuICAgICAgICAvLyByZXF1ZXN0T3B0aW9ucy5wYXJhbXMgPSBDcmVkZW50aWFsU2VydmljZS5oYXdrQmV3aXQodXJsKTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKHJlcXVlc3RPcHRpb25zKTtcbiAgICAgICRodHRwKHJlcXVlc3RPcHRpb25zKS50aGVuKHN1Y2Nlc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKS5maW5hbGx5KGZpbmFsbHlDYWxsYmFjayk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHNlbmRSZXF1ZXN0OiBzZW5kUmVxdWVzdFxuICAgIH1cbiAgfV0pO1xuXG5cblxuIiwiLyoqXG4gKiBDcmVhdGVkIGJ5IGRvcmthYiBvbiAyMDE2LjA3LjE4Li5cbiAqL1xuYW5ndWxhci5tb2R1bGUoJ2FwcC5zZXJ2aWNlcycpXG5cbiAgLmZhY3RvcnkoJ3dvcmtlckZhY3RvcnknLCBbZnVuY3Rpb24gKCkge1xuICAgIHZhciB3b3JrZXJMaXN0ID0gW107XG5cbiAgICBmdW5jdGlvbiBzZXRXb3JrZXJEYXRhKGlkLCBkYXRhKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdvcmtlckxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHdvcmtlckxpc3RbaV0uaWQuaW5kZXhPZihpZCkgPiAtMSkge1xuICAgICAgICAgIHdvcmtlckxpc3RbaV0uc3RhdHVzID0gZGF0YS5jdXJyU3RhdHVzLnN0YXR1cztcbiAgICAgICAgICB3b3JrZXJMaXN0W2ldLmRhdGEgPSBkYXRhO1xuICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtlckxpc3RbaV0uc3RhdHVzKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFkZFdvcmtlcih3b3JrZXIpe1xuICAgICAgd29ya2VyTGlzdFt3b3JrZXJMaXN0Lmxlbmd0aF09d29ya2VyO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBnZXRXb3JrZXJzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB3b3JrZXJMaXN0O1xuICAgICAgfSxcbiAgICAgIGdldFdvcmtlcjogZnVuY3Rpb24gKHdvcmtlcklkKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgd29ya2VyTGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmICh3b3JrZXJMaXN0W2ldLmlkID09PSB3b3JrZXJJZCkge1xuICAgICAgICAgICAgcmV0dXJuIHdvcmtlckxpc3RbaV07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc2V0V29ya2VyRGF0YTogc2V0V29ya2VyRGF0YSxcbiAgICAgIGFkZFdvcmtlcjogYWRkV29ya2VyXG4gICAgfVxuXG5cbiAgfV0pXG5cbiAgLnNlcnZpY2UoJ1dvcmtlclNlcnZpY2UnLCBbJ1JlcXVlc3RTZXJ2aWNlJywgJ3dvcmtlckZhY3RvcnknLCBmdW5jdGlvbiAoUmVxdWVzdFNlcnZpY2UsIHdvcmtlckZhY3RvcnkpIHtcblxuICAgIHZhciBDT01NQU5EX1RZUEUgPSB7XG4gICAgICBzdGFydDogJ3N0YXJ0JyxcbiAgICAgIHN0b3A6ICdzdG9wJyxcbiAgICAgIHJlbG9hZDogJ3JlbG9hZCcsXG4gICAgICBzdGF0dXM6ICdzdGF0dXMnXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGNtZCh3b3JrZXIsIHdvcmtlcmNtZCwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7XG4gICAgICBwYXJhbXMgPSB7XG4gICAgICAgIHdvcmtlcmNtZDogd29ya2VyY21kLFxuICAgICAgICB3b3JrZXJhZGRyOiB3b3JrZXIuaWQsXG4gICAgICAgIGdldFBhcmFtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBcIndvcmtlcmNtZD1cIiArIHRoaXMud29ya2VyY21kICsgXCImd29ya2VyYWRkcj1cIiArIHRoaXMud29ya2VyYWRkcjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGlmICh3b3JrZXJjbWQgPT0gQ09NTUFORF9UWVBFLnJlbG9hZCkge1xuICAgICAgICBmdW5jdGlvbiBkZWZTdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgICB2YXIgaWQgPSByZXNwb25zZS5kYXRhLnJlc3VsdC5pZDtcbiAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGEucmVzdWx0O1xuICAgICAgICAgIHdvcmtlckZhY3Rvcnkuc2V0V29ya2VyRGF0YShpZCwgZGF0YSk7XG4gICAgICAgICAgc3VjY2Vzc0NhbGxiYWNrKHJlc29wbnNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFJlcXVlc3RTZXJ2aWNlLnNlbmRSZXF1ZXN0KG1haW5VUkwgKyBcImNvbnRyb2xsZXIvd29ya2VyY21kXCIsIE1FVEhPRFMuUE9TVCwgdHJ1ZSwgZGVmU3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBwYXJhbXMuZ2V0UGFyYW1zKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUmVxdWVzdFNlcnZpY2Uuc2VuZFJlcXVlc3QobWFpblVSTCArIFwiY29udHJvbGxlci93b3JrZXJjbWRcIiwgTUVUSE9EUy5QT1NULCB0cnVlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssIHBhcmFtcy5nZXRQYXJhbXMoKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5zdGFydCA9IGZ1bmN0aW9uICh3b3JrZXIsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgY21kKHdvcmtlciwgQ09NTUFORF9UWVBFLnN0YXJ0LCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spXG4gICAgfTtcbiAgICB0aGlzLnN0b3AgPSBmdW5jdGlvbiAod29ya2VyLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHtcbiAgICAgIGNtZCh3b3JrZXIsIENPTU1BTkRfVFlQRS5zdG9wLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spXG4gICAgfTtcbiAgICB0aGlzLnJlbG9hZCA9IGZ1bmN0aW9uICh3b3JrZXIsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgY21kKHdvcmtlciwgQ09NTUFORF9UWVBFLnJlbG9hZCwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKVxuICAgIH07XG4gICAgdGhpcy5zdGF0dXMgPSBmdW5jdGlvbiAod29ya2VyLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHtcbiAgICAgIGNtZCh3b3JrZXIsIENPTU1BTkRfVFlQRS5zdGF0dXMsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaylcbiAgICB9O1xuICAgIHRoaXMuY21kID0gZnVuY3Rpb24gKHdvcmtlciwgdHlwZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7XG4gICAgICBjbWQod29ya2VyLCB0eXBlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIG1vY2tGZXRjaCgpIHtcblxuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICAgIG5hbWUgPSBcIndvcmtlciBcIiArIGk7XG4gICAgICAgIGlkID0gaSAlIDkgPyAgXCIvaG9zdCAtIHdvcmtlciBcIiArIGk6XCJob3N0IC0gd29ya2VyIFwiICsgaTtcbiAgICAgICAgd29ya2VyRmFjdG9yeS5hZGRXb3JrZXIoe1xuICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgIG1hc3RlcjogaWQuaW5kZXhPZihcIi9cIikgPCAwLFxuICAgICAgICAgIHN0YXR1czogKGkgJSA5KSA/ICAoKGkgJSA0KSA/IFwid29ya2luZ1wiOlwic3RvcHBlZFwiKSA6XCJtYXN0ZXJcIixcbiAgICAgICAgICBkYXRhOiB7fVxuXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZmV0Y2g9ZnVuY3Rpb24oZmluYWxseUNhbGxiYWNrKSB7XG4gICAgICBmdW5jdGlvbiBzdWNjZXNzQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgIHZhciBpZHMgPSBPYmplY3Qua2V5cyhyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICB2YXIgaWQgPSBpZHNbaV07XG4gICAgICAgICAgdmFyIG5hbWUgPSByZXNwb25zZS5kYXRhW2lkXTtcbiAgICAgICAgICB3b3JrZXJGYWN0b3J5LmFkZFdvcmtlcih7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgbWFzdGVyOiBpZC5pbmRleE9mKFwiL1wiKSA8IDAsXG4gICAgICAgICAgICBzdGF0dXM6IFwibWFzdGVyXCIsXG4gICAgICAgICAgICBkYXRhOiB7fVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHNldFN0YXR1c2VzKCk7XG4gICAgICB9XG5cbiAgICAgIGZ1bmN0aW9uIGVycm9yQ2FsbGJhY2socmVzcG9uc2UpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJmYWlsXCIpO1xuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKTtcbiAgICAgIH1cblxuICAgICAgUmVxdWVzdFNlcnZpY2Uuc2VuZFJlcXVlc3QobWFpblVSTCArIFwiY29udHJvbGxlci9hZGRyZXNzYm9va1wiLCBNRVRIT0RTLkdFVCwgdHJ1ZSwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBudWxsLCBmaW5hbGx5Q2FsbGJhY2spO1xuICAgICAgLy8gbW9ja0ZldGNoKClcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzZXRTdGF0dXNlcygpIHtcbiAgICAgIHZhciB3b3JrZXJMaXN0PXdvcmtlckZhY3RvcnkuZ2V0V29ya2VycygpXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHdvcmtlckxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKCF3b3JrZXJMaXN0W2ldLm1hc3Rlcikge1xuICAgICAgICAgIHN0YXR1cyh3b3JrZXJMaXN0W2ldLFxuICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cblxuICB9XSlcblxuICAuc2VydmljZSgnTWFzdGVyU2VydmljZScsIFsnUmVxdWVzdFNlcnZpY2UnLCBmdW5jdGlvbiAoUmVxdWVzdFNlcnZpY2UpIHtcblxuICAgIHZhciBDT01NQU5EX1RZUEUgPSB7XG4gICAgICByZWdpc3RyeTogJ3JlZ2lzdHJ5JyxcbiAgICAgIHNodXRkb3duOiAnc2h1dGRvd24nXG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGNtZCh3b3JrZXIsIG1hc3RlcmNtZCwgc3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrKSB7XG4gICAgICBwYXJhbXMgPSB7XG4gICAgICAgIG1hc3RlcmNtZDogbWFzdGVyY21kLFxuICAgICAgICBtYXN0ZXJhZGRyOiB3b3JrZXIuaWQsXG4gICAgICAgIGdldFBhcmFtczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiBcIm1hc3RlcmNtZD1cIiArIHRoaXMubWFzdGVyY21kICsgXCImbWFzdGVyYWRkcj1cIiArIHRoaXMubWFzdGVyYWRkcjtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGlmIChtYXN0ZXJjbWQgPT0gQ09NTUFORF9UWVBFLnJlZ2lzdHJ5KSB7XG4gICAgICAgIGZ1bmN0aW9uIGRlZlN1Y2Nlc3NDYWxsYmFjayhyZXNwb25zZSkge1xuXG4gICAgICAgICAgc3VjY2Vzc0NhbGxiYWNrKHJlc3BvbnNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFJlcXVlc3RTZXJ2aWNlLnNlbmRSZXF1ZXN0KG1haW5VUkwgKyBcImNvbnRyb2xsZXIvbWFzdGVyY21kXCIsIE1FVEhPRFMuUE9TVCwgdHJ1ZSwgZGVmU3VjY2Vzc0NhbGxiYWNrLCBlcnJvckNhbGxiYWNrLCBwYXJhbXMuZ2V0UGFyYW1zKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgUmVxdWVzdFNlcnZpY2Uuc2VuZFJlcXVlc3QobWFpblVSTCArIFwiY29udHJvbGxlci9tYXN0ZXJjbWRcIiwgTUVUSE9EUy5QT1NULCB0cnVlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2ssIHBhcmFtcy5nZXRQYXJhbXMoKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlZ2lzdHJ5OiBmdW5jdGlvbiAod29ya2VyLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spIHtcbiAgICAgICAgY21kKHdvcmtlciwgQ09NTUFORF9UWVBFLnJlZ2lzdHJ5LCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spXG4gICAgICB9LFxuICAgICAgc2h1dGRvd246IGZ1bmN0aW9uICh3b3JrZXIsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgICBjbWQod29ya2VyLCBDT01NQU5EX1RZUEUuc2h1dGRvd24sIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaylcbiAgICAgIH0sXG4gICAgICBjbWQ6IGZ1bmN0aW9uICh3b3JrZXIsIHR5cGUsIHN1Y2Nlc3NDYWxsYmFjaywgZXJyb3JDYWxsYmFjaykge1xuICAgICAgICBjbWQod29ya2VyLCB0eXBlLCBzdWNjZXNzQ2FsbGJhY2ssIGVycm9yQ2FsbGJhY2spXG4gICAgICB9XG4gICAgfVxuICB9XSk7XG4iLCIvKipcbiAqIENyZWF0ZWQgYnkgZG9ya2FiIG9uIDIwMTYuMDcuMTguLlxuICovXG5cbm1haW5VUkwgPSAnaHR0cHM6Ly9tc3AubWZmLmh1L3YwLjIvJztcbi8vIG1haW5VUkwgPSAnaHR0cDovL2xvY2FsaG9zdDozMDE1MC8nO1xuXG5NRVRIT0RTID0ge1xuICBHRVQ6IFwiR0VUXCIsXG4gIFBPU1Q6IFwiUE9TVFwiXG59O1xuXG4iXX0=
